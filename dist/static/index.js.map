{
  "version": 3,
  "sources": ["../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/signal.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/utils.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/domInterop.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/component.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/portal.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/index.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/cinnabun.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/ssr.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/hydration.ts", "../../src/Document.tsx", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/router/router.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/router/link.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/router/index.ts", "../../src/state/global.ts", "../../src/components/icons/UserIcon.tsx", "../../node_modules/.pnpm/cinnabun-transitions@1.0.6/node_modules/cinnabun-transitions/src/useTransition.ts", "../../node_modules/.pnpm/cinnabun-transitions@1.0.6/node_modules/cinnabun-transitions/src/Transition.tsx", "../../node_modules/.pnpm/cinnabun-transitions@1.0.6/node_modules/cinnabun-transitions/src/FadeInOut.tsx", "../../node_modules/.pnpm/cinnabun-transitions@1.0.6/node_modules/cinnabun-transitions/src/SlideInOut.tsx", "../../src/components/UserDropdown.tsx", "../../src/components/UserAvatar.tsx", "../../src/components/Portal.tsx", "../../src/utils.ts", "../../src/components/Notifications.tsx", "../../src/constants.tsx", "../../src/client/actions/communities.ts", "../../src/state/community.ts", "../../src/components/loaders/Default.tsx", "../../src/components/AuthorTag.tsx", "../../src/pages/Home.tsx", "../../src/components/communities/CommunityListCard.tsx", "../../src/components/communities/CommunityList.tsx", "../../src/components/Button.tsx", "../../src/pages/Communities.tsx", "../../src/components/IconButton.tsx", "../../src/components/icons/ThumbsUpIcon.tsx", "../../src/components/icons/ThumbsDownIcon.tsx", "../../src/client/actions/posts.ts", "../../src/components/loaders/Ellipsis.tsx", "../../src/db/validation.ts", "../../src/components/community/PostCardComments.tsx", "../../src/components/community/PostCard.tsx", "../../src/components/community/CommunityPosts.tsx", "../../src/components/community/CommunityMemberCard.tsx", "../../src/components/icons/EditIcon.tsx", "../../src/components/icons/MenuIcon.tsx", "../../src/components/icons/MoreIcon.tsx", "../../src/components/community/AddPostButton.tsx", "../../src/components/community/CommunityFixedHeader.tsx", "../../src/components/community/PendingJoinRequests.tsx", "../../src/components/community/AdminMenu/AdminMenu.tsx", "../../src/pages/Community/Page.tsx", "../../src/client/actions/me.ts", "../../src/components/user/MyCommunities.tsx", "../../src/client/actions/users.ts", "../../src/pages/User/Page.tsx", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/listeners/KeyboardListener.ts", "../../node_modules/.pnpm/cinnabun@0.1.50/node_modules/cinnabun/src/listeners/NavigationListener.ts", "../../src/components/modal/Modal.tsx", "../../src/components/communities/CommunityCreator.tsx", "../../src/components/community/PostCreator.tsx", "../../src/components/community/CommunityEditor.tsx", "../../src/components/community/CommunityJoinPrompt.tsx", "../../src/components/icons/auth/GoogleIcon.tsx", "../../src/components/icons/auth/GithubIcon.tsx", "../../src/components/auth/AuthModal.tsx", "../../src/components/communities/CommunitySearch.tsx", "../../src/components/icons/UsersIcon.tsx", "../../src/components/icons/GlobeIcon.tsx", "../../src/components/MenuButton.tsx", "../../src/components/sidebar/Sidebar.tsx", "../../src/components/drawer/Drawer.tsx", "../../src/components/community/CommunityDrawer.tsx", "../../src/components/community/CommunityLeaveConfirmation.tsx", "../../src/components/community/CommunityDeleteConfirmation.tsx", "../../src/App.tsx", "../../src/client/liveSocket.ts", "../../src/client/index.ts"],
  "sourcesContent": ["// Disclaimer: I stole this from EmNudge. Subscribe and pay respects to lord EmNudge.\r\n\r\nconst LOG_NUM_SUBS = false\r\n\r\nexport class Signal<T> {\r\n  private _val: T\r\n  private _subscribers: Set<{ (val: T): any }> = new Set()\r\n  private _name?: string\r\n  constructor(value: T, name?: string) {\r\n    this._val = value\r\n    this._name = name\r\n  }\r\n\r\n  get value() {\r\n    return this._val\r\n  }\r\n\r\n  set value(newVal: T) {\r\n    this._val = newVal\r\n    this.notify()\r\n  }\r\n\r\n  notify() {\r\n    for (const subscribeFunc of this._subscribers) {\r\n      subscribeFunc(this._val)\r\n    }\r\n  }\r\n\r\n  subscribe(func: { (val: T): any }) {\r\n    this._subscribers.add(func)\r\n    this.logSubscriberCount()\r\n    func(this._val)\r\n    return () => this.unsubscribe(func)\r\n  }\r\n  unsubscribe(func: { (val: T): any }) {\r\n    this._subscribers.delete(func)\r\n    this.logSubscriberCount()\r\n  }\r\n\r\n  serialize(): string {\r\n    return JSON.stringify(this.value)\r\n  }\r\n\r\n  logSubscriberCount() {\r\n    if (LOG_NUM_SUBS)\r\n      console.debug(this._name + \" subscribers:\", this._subscribers.size)\r\n  }\r\n}\r\n\r\nexport function computed<T>(signal: Signal<any>, func: { (): T }): Signal<T> {\r\n  const _signal = new Signal<T | null>(null)\r\n  _signal.value = func()\r\n  signal.subscribe(() => {\r\n    _signal.value = func()\r\n  })\r\n\r\n  return _signal as Signal<T>\r\n}\r\n\r\nexport function createSignal<T>(initialValue: T) {\r\n  return new Signal<T>(initialValue)\r\n}\r\n", "import { Signal } from \"./signal\"\r\nimport { ComponentProps } from \"./types\"\r\n\r\nexport const sleep = async (ms: number) => {\r\n  return new Promise((resolve) => setTimeout(resolve, ms))\r\n}\r\n\r\nexport const getCookie = (key: string) => {\r\n  const cookies = document.cookie.split(\";\")\r\n  for (let i = 0; i < cookies.length; i++) {\r\n    const cookie = cookies[i].trim()\r\n    if (cookie.startsWith(key + \"=\")) {\r\n      try {\r\n        const res = decodeURIComponent(cookie.substring(key.length + 1))\r\n        return JSON.parse(res)\r\n      } catch (error) {\r\n        console.error(\"getCookie error\", error)\r\n        return null\r\n      }\r\n    }\r\n  }\r\n  return null\r\n}\r\n\r\nexport const getInputType = (val: any): string => {\r\n  switch (typeof val) {\r\n    case \"boolean\":\r\n      return \"checkbox\"\r\n    case \"number\":\r\n      return \"number\"\r\n    case \"string\":\r\n    case undefined:\r\n      return \"text\"\r\n  }\r\n  throw new Error(\r\n    \"unable to get input type for val with type: \" + typeof val + \" - \" + val\r\n  )\r\n}\r\n\r\nexport const jsPropToHtmlProp = (prop: string): string => {\r\n  switch (prop) {\r\n    case \"className\":\r\n      return \"class\"\r\n    default:\r\n      return prop\r\n  }\r\n}\r\n\r\nexport const htmlPropToJsProp = (prop: string): string => {\r\n  switch (prop) {\r\n    case \"class\":\r\n      return \"className\"\r\n    default:\r\n      return prop\r\n  }\r\n}\r\n\r\nexport const validHtmlProps = (props: ComponentProps & Record<string, any>) => {\r\n  const validProps: Record<string, any> = {}\r\n  Object.keys(props).forEach((k) => {\r\n    if (k.includes(\":\")) return\r\n    if (k === \"innerText\") return\r\n    if (k === \"children\") return\r\n    if (k === \"promise\") return\r\n    if (k === \"className\") {\r\n      validProps.class = props[k]\r\n      return\r\n    }\r\n    if (props[k] instanceof Signal) {\r\n      validProps[k] = props[k].value\r\n      return\r\n    }\r\n    validProps[k] = props[k]\r\n  })\r\n  return validProps\r\n}\r\n\r\nexport const generateUUID = () => {\r\n  // Public Domain/MIT\r\n  var d = new Date().getTime() //Timestamp\r\n  var d2 =\r\n    (typeof performance !== \"undefined\" &&\r\n      performance.now &&\r\n      performance.now() * 1000) ||\r\n    0 //Time in microseconds since page-load or 0 if unsupported\r\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\r\n    var r = Math.random() * 16 //random number between 0 and 16\r\n    if (d > 0) {\r\n      //Use timestamp until depleted\r\n      r = (d + r) % 16 | 0\r\n      d = Math.floor(d / 16)\r\n    } else {\r\n      //Use microseconds since page-load if supported\r\n      r = (d2 + r) % 16 | 0\r\n      d2 = Math.floor(d2 / 16)\r\n    }\r\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16)\r\n  })\r\n}\r\n", "import { Component, Signal } from \".\"\r\nimport { Cinnabun } from \"./cinnabun\"\r\nimport { FragmentComponent } from \"./component\"\r\nimport { ComponentChild, DiffCheckResult, DiffType } from \"./types\"\r\nimport { jsPropToHtmlProp, validHtmlProps } from \"./utils\"\r\n\r\nexport class DomInterop {\r\n  static updateElement(component: Component) {\r\n    if (!component.element) return\r\n    const {\r\n      htmlFor,\r\n      children,\r\n      onMounted,\r\n      subscription,\r\n      visible,\r\n      style,\r\n      promise,\r\n      ...rest\r\n    } = component.props\r\n\r\n    const isSVG = component.isSVG()\r\n\r\n    if (style) {\r\n      if (typeof style === \"object\") {\r\n        Object.assign(component.element.style, style)\r\n      } else {\r\n        component.element.setAttribute(\"style\", style)\r\n      }\r\n    }\r\n    if (htmlFor && \"htmlFor\" in component.element) {\r\n      component.element.htmlFor = htmlFor\r\n    }\r\n    if (Object.keys(rest).length) {\r\n      for (const [k, v] of Object.entries(rest)) {\r\n        if (k.includes(\":\")) continue\r\n        if (k === \"hydrating\") continue\r\n        if (k.startsWith(\"on\")) {\r\n          Object.assign(component.element, { [k]: v })\r\n          continue\r\n        }\r\n        if (isSVG) {\r\n          component.element.setAttribute(\r\n            jsPropToHtmlProp(k),\r\n            component.getPrimitive(v, () => DomInterop.updateElement(component))\r\n          )\r\n        } else {\r\n          Object.assign(component.element, {\r\n            [k]: component.getPrimitive(v, () =>\r\n              DomInterop.updateElement(component)\r\n            ),\r\n          })\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  static getRenderedChildren(component: Component) {\r\n    return component.children.map((c, i) =>\r\n      DomInterop.renderChild(component, c, i)\r\n    )\r\n  }\r\n\r\n  static renderChildren(component: Component) {\r\n    if (!component.props.visible) return\r\n    if (!component.element) return\r\n    DomInterop.removeFuncComponents(component)\r\n\r\n    component.element.replaceChildren(\r\n      ...DomInterop.getRenderedChildren(component)\r\n    )\r\n  }\r\n\r\n  static renderChild(\r\n    component: Component,\r\n    child: ComponentChild,\r\n    idx: number\r\n  ): string | Node {\r\n    if (child instanceof Signal) {\r\n      component.subscribeTo((_, __) =>\r\n        child.subscribe(() => {\r\n          const { element } = component.element\r\n            ? { element: component.element }\r\n            : DomInterop.getMountLocation(component)\r\n          if (!element) {\r\n            console.error(\r\n              \"Failed to get component mount element\",\r\n              component,\r\n              child\r\n            )\r\n            return\r\n          }\r\n          const c = element.childNodes[idx]\r\n          if (c) c.nodeValue = child.value.toString()\r\n        })\r\n      )\r\n      return child.value.toString()\r\n    }\r\n    if (child instanceof Component) {\r\n      if (!child.props.visible || child.isStatic) return \"\"\r\n      child.parent = component\r\n      return DomInterop.render(child)\r\n    }\r\n    if (typeof child === \"function\") {\r\n      let c = child(...component.childArgs)\r\n      if (Array.isArray(c)) c = new FragmentComponent(c)\r\n      const res = DomInterop.renderChild(component, c, idx)\r\n      if (c instanceof Component) {\r\n        if (!c.props.visible || c.isStatic) return \"\"\r\n        c.parent = component\r\n        component.funcComponents.push(c)\r\n      }\r\n      return res\r\n    }\r\n    return child?.toString() ?? \"\"\r\n  }\r\n\r\n  static removeFuncComponents(component: Component) {\r\n    if (component.funcComponents.length > 0) {\r\n      for (const fc of component.funcComponents) {\r\n        DomInterop.unRender(fc)\r\n        Cinnabun.removeComponentReferences(fc)\r\n      }\r\n      component.funcComponents = []\r\n    }\r\n  }\r\n\r\n  static unRender(component: Component, forceSync: boolean = false) {\r\n    try {\r\n      // handle delayed/cancellable unmounting\r\n      if (!forceSync && component.props.onBeforeUnmounted) {\r\n        const res = component.props.onBeforeUnmounted(component)\r\n        if (res instanceof Promise) {\r\n          res.then((res) => {\r\n            if (res && component.mounted) DomInterop.unRender(component, true)\r\n          })\r\n          return\r\n        } else if (res === false) {\r\n          return\r\n        }\r\n      }\r\n\r\n      DomInterop.removeFuncComponents(component)\r\n      if (component.element) {\r\n        component.unMount()\r\n        return component.element.remove()\r\n      }\r\n      for (const c of component.children) {\r\n        if (c instanceof Component) {\r\n          DomInterop.unRender(c)\r\n        } else if (c instanceof Node) {\r\n          c.parentNode?.removeChild(c)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"failed to unrender\", component, error)\r\n      debugger\r\n    }\r\n  }\r\n\r\n  static reRender(component: Component) {\r\n    if (!component.shouldRender()) return\r\n    const el = component.element ?? DomInterop.render(component, true)\r\n    if (component.element) DomInterop.renderChildren(component)\r\n    if (el.isConnected) return\r\n\r\n    const { element, idx } = DomInterop.getMountLocation(component)\r\n    if (!element) {\r\n      debugger\r\n      console.error(\"Failed to get component mount element\", component, el)\r\n      return\r\n    }\r\n    //element.children[idx] is our actual previous child but be need to insert before the next.\r\n    const prevChild = element.childNodes[idx - 1]\r\n\r\n    if (prevChild) {\r\n      element.insertBefore(el, prevChild)\r\n    } else {\r\n      element.appendChild(el)\r\n    }\r\n    component.mounted = true\r\n  }\r\n\r\n  static render(component: Component, isRerender: boolean = false) {\r\n    const { children, subscription, promise } = component.props\r\n\r\n    Cinnabun.removeComponentReferences(component)\r\n\r\n    if (!component.tag) {\r\n      const f = document.createDocumentFragment()\r\n      if (subscription) component.subscribeTo(subscription)\r\n      f.append(...DomInterop.getRenderedChildren(component))\r\n      component.mounted = true\r\n\r\n      if (\r\n        !isRerender &&\r\n        \"setPromise\" in component &&\r\n        typeof component.setPromise === \"function\"\r\n      ) {\r\n        component.setPromise(promise)\r\n      }\r\n\r\n      return f\r\n    }\r\n\r\n    if (component.tag.toLowerCase() === \"svg\") return DomInterop.svg(component)\r\n    if (!component.element) {\r\n      component.element = document.createElement(component.tag) as HTMLElement\r\n    }\r\n\r\n    if (children) component.replaceChildren(children)\r\n\r\n    DomInterop.renderChildren(component)\r\n\r\n    DomInterop.updateElement(component)\r\n\r\n    if (subscription) component.subscribeTo(subscription)\r\n\r\n    component.mounted = true\r\n    return component.element\r\n  }\r\n\r\n  static diffCheckChildren(\r\n    children: Component[],\r\n    newChildren: Component[]\r\n  ): DiffCheckResult[] {\r\n    const childKeys = children.map((c) => c.props.key)\r\n    const newChildKeys = newChildren.map((c) => c.props.key)\r\n\r\n    const addedKeys = newChildren\r\n      .filter((c) => !childKeys.includes(c.props.key!))\r\n      .map((c) => c.props.key!)\r\n\r\n    const removedKeys = children\r\n      .filter((c) => !newChildKeys.includes(c.props.key!))\r\n      .map((c) => c.props.key!)\r\n\r\n    const changedKeys = newChildren\r\n      .filter(\r\n        (c) =>\r\n          !addedKeys.includes(c.props.key!) &&\r\n          !removedKeys.includes(c.props.key!)\r\n      )\r\n      .filter((nc) => {\r\n        const oldChild = children.find((oc) => oc.props.key === nc.props.key)!\r\n        return JSON.stringify(oldChild.props) !== JSON.stringify(nc.props)\r\n\r\n        // node equality is not worth it - it's definitely slower and means that\r\n        // external changes to element attributes (style etc...) during runtime will\r\n        // cause the child to be considered 'changed', even for a simple list addition.\r\n\r\n        //return !DomInterop.render(nc).isEqualNode(oldChild.element!)\r\n      })\r\n      .map((c) => c.props.key!)\r\n\r\n    const unchangedKeys = children\r\n      .filter(\r\n        (c) =>\r\n          !addedKeys.includes(c.props.key!) &&\r\n          !removedKeys.includes(c.props.key!) &&\r\n          !changedKeys.includes(c.props.key!)\r\n      )\r\n      .map((c) => c.props.key!)\r\n\r\n    return [\r\n      ...addedKeys.map((k) => {\r\n        return {\r\n          result: DiffType.ADDED,\r\n          key: k,\r\n          node: newChildren.find((c) => c.props.key === k)!.element,\r\n        }\r\n      }),\r\n      ...removedKeys.map((k) => {\r\n        return {\r\n          result: DiffType.REMOVED,\r\n          key: k,\r\n          node: children.find((c) => c.props.key === k)!.element,\r\n        }\r\n      }),\r\n      ...changedKeys.map((k) => {\r\n        return {\r\n          result: DiffType.CHANGED,\r\n          key: k,\r\n          node: children.find((c) => c.props.key === k)!.element,\r\n        }\r\n      }),\r\n      ...unchangedKeys.map((k) => {\r\n        return {\r\n          result: DiffType.NONE,\r\n          key: k,\r\n          node: children.find((c) => c.props.key === k)!.element,\r\n        }\r\n      }),\r\n    ]\r\n  }\r\n\r\n  static diffMergeChildren(parent: Component, newChildren: Component[]) {\r\n    const oldChildren = parent.children as Component[]\r\n    try {\r\n      const diffs = DomInterop.diffCheckChildren(oldChildren, newChildren)\r\n      for (let i = 0; i < diffs.length; i++) {\r\n        const diff = diffs[i]\r\n        switch (diff.result) {\r\n          case DiffType.ADDED: {\r\n            const newC = newChildren.find((c) => c.props.key === diff.key)!\r\n            parent.insertChildren(newChildren.indexOf(newC), newC)\r\n            break\r\n          }\r\n          case DiffType.REMOVED: {\r\n            const oldC = (parent.children as (Component | null)[]).find(\r\n              (c) => c?.props.key === diff.key\r\n            )!\r\n            parent.removeChildren(oldC)\r\n            break\r\n          }\r\n          case DiffType.CHANGED: {\r\n            const oldC = (parent.children as (Component | null)[]).find(\r\n              (c) => c?.props.key === diff.key\r\n            )!\r\n            const newC = newChildren.find((c) => c.props.key === diff.key)!\r\n            Cinnabun.removeComponentReferences(newC)\r\n            Object.assign(oldC.props, newC.props)\r\n            DomInterop.updateElement(oldC)\r\n\r\n            break\r\n          }\r\n          case DiffType.NONE:\r\n          default:\r\n            {\r\n              // recurse into children and ensure they are up to date\r\n              const oldC = parent.children.find(\r\n                (c) => c instanceof Component && c.props.key === diff.key\r\n              ) as Component\r\n              const newC = newChildren.find(\r\n                (c) => c instanceof Component && c.props.key === diff.key\r\n              )\r\n              if (newC) Cinnabun.removeComponentReferences(newC)\r\n              if (oldC && newC) {\r\n                DomInterop.diffMergeChildren(\r\n                  oldC,\r\n                  newC.children.filter(\r\n                    (c) => c instanceof Component\r\n                  ) as Component[]\r\n                )\r\n              }\r\n            }\r\n\r\n            break\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"failed to diff merge children\", parent, newChildren, error)\r\n    }\r\n    parent.children = parent.children.filter((c) => c !== null)\r\n  }\r\n\r\n  static svg(component: Component): SVGSVGElement {\r\n    const el = document.createElementNS(\r\n      \"http://www.w3.org/2000/svg\",\r\n      component.tag\r\n    )\r\n\r\n    const { visible, ...props } = component.props\r\n\r\n    const validProps = Object.entries(validHtmlProps(props))\r\n\r\n    for (const [k, v] of validProps) {\r\n      // convert camelCase to kebab-case\r\n      //const _k = k.replace(/([a-z])([A-Z])/g, \"$1-$2\").toLowerCase()\r\n      // skip bind: props\r\n      if (k.includes(\"bind:\")) continue\r\n      // convert className to class\r\n      const _k2 = k === \"className\" ? \"class\" : k\r\n\r\n      el.setAttribute(_k2, v.toString())\r\n    }\r\n\r\n    for (const c of component.children) {\r\n      if (typeof c === \"string\" || typeof c === \"number\") {\r\n        el.append(c.toString())\r\n      } else {\r\n        if (typeof c === \"function\") {\r\n          const val = c()\r\n          if (typeof val === \"string\" || typeof val === \"number\") {\r\n            el.append(val.toString())\r\n          } else {\r\n            el.append(DomInterop.svg(val))\r\n          }\r\n        } else {\r\n          if (c) el.append(DomInterop.svg(c))\r\n        }\r\n      }\r\n    }\r\n\r\n    //@ts-ignore\r\n    return el as SVGElement\r\n  }\r\n\r\n  static getMountLocation(\r\n    component: Component,\r\n    start = 0\r\n  ): { element: HTMLElement | SVGSVGElement | null; idx: number } {\r\n    if (!component.parent) return { element: null, idx: -1 }\r\n\r\n    for (let i = 0; i < component.parent.children.length; i++) {\r\n      const c = component.parent.children[i]\r\n      if (c === component) break\r\n      start += DomInterop.getRenderedNodeCount(c)\r\n    }\r\n    if (component.parent.element)\r\n      return { element: component.parent.element, idx: start + 1 }\r\n\r\n    return DomInterop.getMountLocation(component.parent, start)\r\n  }\r\n\r\n  static getRenderedNodeCount(child: ComponentChild): number {\r\n    let count = 0\r\n    if (child instanceof Component) {\r\n      if (!child.props.visible) return 0\r\n      if (child.tag) return 1\r\n\r\n      for (const c of child.children) {\r\n        count += DomInterop.getRenderedNodeCount(c)\r\n      }\r\n      for (const c of child.funcComponents) {\r\n        count += DomInterop.getRenderedNodeCount(c)\r\n      }\r\n    } else if (child instanceof Signal) {\r\n      count++\r\n    } else if (typeof child === \"string\" || typeof child === \"number\") {\r\n      count++\r\n    }\r\n\r\n    return count\r\n  }\r\n}\r\n", "import { Cinnabun } from \"./cinnabun\"\r\nimport { DomInterop } from \"./domInterop\"\r\n\r\nimport { Signal } from \"./signal\"\r\nimport {\r\n  ComponentSubscription,\r\n  ComponentProps,\r\n  ComponentChild,\r\n  ClassConstructor,\r\n  ComponentChildren,\r\n  TemplateFunc,\r\n  ForProps,\r\n  SuspenseProps,\r\n  ComponentFunc,\r\n} from \"./types\"\r\n\r\nexport class Component {\r\n  parent: Component | null = null\r\n  children: ComponentChild[] = []\r\n  funcComponents: Component[] = []\r\n  element: HTMLElement | SVGSVGElement | undefined\r\n  cbInstance: Cinnabun | undefined\r\n  isStatic: boolean = false\r\n\r\n  private _mounted: boolean = false\r\n  get mounted() {\r\n    return this._mounted\r\n  }\r\n  set mounted(val: boolean) {\r\n    const changed = this._mounted !== val\r\n    this._mounted = val\r\n    if (changed && val && this._props.onMounted) {\r\n      setTimeout(() => {\r\n        this._props.onMounted!(this)\r\n      }, 0)\r\n    } else if (changed && !val && this._props.onUnmounted) {\r\n      this._props.onUnmounted(this)\r\n    }\r\n\r\n    if (changed && this._props.ref) {\r\n      this._props.ref.value = this.mounted && this.element ? this.element : null\r\n    }\r\n  }\r\n\r\n  private subscription: ComponentSubscription | undefined\r\n  private _props: ComponentProps = {}\r\n  constructor(public tag: string, props: ComponentProps = {}) {\r\n    if (!(\"visible\" in props)) props.visible = true\r\n    this.props = props\r\n  }\r\n  get props() {\r\n    return this._props\r\n  }\r\n  set props(props: ComponentProps) {\r\n    const { children, watch, ...rest } = props\r\n\r\n    Object.assign(this._props, rest)\r\n    if (children) this.replaceChildren(children)\r\n\r\n    if (Cinnabun.isClient && watch) {\r\n      this._props.watch = watch\r\n      const signals = \"length\" in watch ? watch : [watch]\r\n      for (const s of signals) {\r\n        const unsub = s.subscribe(this.applyBindProps.bind(this))\r\n        Cinnabun.addComponentReference({\r\n          component: this,\r\n          onDestroyed: () => unsub(),\r\n        })\r\n      }\r\n    }\r\n    //if (this.props.ref) this.props.ref.value = this.element ?? null\r\n  }\r\n\r\n  get childArgs(): any[] {\r\n    return []\r\n  }\r\n\r\n  applyBindProps() {\r\n    const bindFns = Object.entries(this.props).filter(([k]) =>\r\n      k.startsWith(\"bind:\")\r\n    )\r\n    for (const [k, v] of bindFns) {\r\n      const propName = k.substring(k.indexOf(\":\") + 1)\r\n      const val = this.getPrimitive(v, () => DomInterop.reRender(this))\r\n      const oldVal = this._props[propName]\r\n      this._props[propName] =\r\n        propName === \"children\" && val === true ? oldVal : val\r\n\r\n      if (propName === \"visible\" && Cinnabun.isClient) {\r\n        if (val !== oldVal) {\r\n          if (val && this.parent?._props.visible) {\r\n            DomInterop.reRender(this)\r\n          } else {\r\n            if (this.mounted) DomInterop.unRender(this)\r\n          }\r\n        }\r\n      } else if (propName === \"children\") {\r\n        if (this._props.children) this.replaceChildren(this._props.children)\r\n        if (Cinnabun.isClient) DomInterop.renderChildren(this)\r\n      } else if (this.element) {\r\n        Object.assign(this.element, { [propName]: this._props[propName] })\r\n      }\r\n    }\r\n  }\r\n\r\n  getPrimitive(prop: any, signalCallback?: { (): void }): any {\r\n    if (prop instanceof Signal) {\r\n      if (signalCallback)\r\n        this.subscribeTo((_, __) => prop.subscribe(signalCallback.bind(this)))\r\n      return prop.value\r\n    }\r\n    if (typeof prop === \"function\")\r\n      return this.getPrimitive(prop(this), signalCallback)\r\n    return prop\r\n  }\r\n\r\n  subscribeTo(subscription: ComponentSubscription) {\r\n    if (this.subscription) return\r\n    this.subscription = subscription\r\n\r\n    const setProps = (props: ComponentProps) => {\r\n      this.props = Object.assign(this.props, props)\r\n    }\r\n    const unsubscriber = this.subscription(setProps, this)\r\n    Cinnabun.addComponentReference({\r\n      component: this,\r\n      onDestroyed: () => unsubscriber(),\r\n    })\r\n  }\r\n\r\n  removeChildren(...children: ComponentChildren) {\r\n    for (const child of children) {\r\n      const idx = this.children.indexOf(child)\r\n      if (child instanceof Component) {\r\n        this.destroyComponentRefs(child)\r\n        child.parent = null\r\n        DomInterop.unRender(child)\r\n      }\r\n      this.children[idx] = null\r\n    }\r\n  }\r\n\r\n  insertChildren(index: number, ...children: ComponentChildren) {\r\n    this.children.splice(index, 0, ...children)\r\n    for (const child of children) {\r\n      if (child instanceof Component) {\r\n        child.parent = this\r\n        DomInterop.reRender(child)\r\n      }\r\n    }\r\n  }\r\n\r\n  appendChildren(...children: ComponentChildren) {\r\n    this.children.push(...children)\r\n    for (const child of children) {\r\n      if (child instanceof Component) {\r\n        child.parent = this\r\n        DomInterop.reRender(child)\r\n      }\r\n    }\r\n  }\r\n\r\n  prependChildren(...children: ComponentChildren) {\r\n    this.children.unshift(...children)\r\n    for (const child of children) {\r\n      if (child instanceof Component) {\r\n        child.parent = this\r\n        DomInterop.reRender(child)\r\n      }\r\n    }\r\n  }\r\n\r\n  replaceChild(child: Component, newChild: Component) {\r\n    DomInterop.unRender(child)\r\n    this.destroyComponentRefs(child)\r\n    const idx = this.children.indexOf(child)\r\n    this.children[idx] = newChild\r\n    newChild.parent = this\r\n    DomInterop.reRender(newChild)\r\n  }\r\n  replaceChildren(newChildren: ComponentChild[]) {\r\n    this.destroyChildComponentRefs(this)\r\n    this.children = newChildren.map((c) =>\r\n      Array.isArray(c) ? new FragmentComponent(c) : c\r\n    )\r\n    this.linkChildren()\r\n  }\r\n\r\n  linkChildren() {\r\n    for (let i = 0; i < this.children.length; i++) {\r\n      const c = this.children[i]\r\n      if (c instanceof Component) {\r\n        c.parent = this\r\n        c.cbInstance = this.cbInstance\r\n        c.linkChildren()\r\n      }\r\n    }\r\n  }\r\n\r\n  destroyChildComponentRefs(el: Component) {\r\n    for (const c of el.children) {\r\n      if (typeof c === \"string\" || typeof c === \"number\") continue\r\n      if (typeof c === \"function\") continue\r\n      if (!c) continue\r\n      this.destroyComponentRefs(c)\r\n    }\r\n  }\r\n\r\n  shouldRender(): boolean {\r\n    if (!this._props.visible) return false\r\n    if (this.parent) return this.parent.shouldRender()\r\n    return true\r\n  }\r\n\r\n  destroyComponentRefs(el: Component) {\r\n    this.destroyChildComponentRefs(el)\r\n    //el.parent = null\r\n    const subs = Cinnabun.getComponentReferences(el).filter(\r\n      (s) => s.component === el\r\n    )\r\n    while (subs.length) {\r\n      subs.pop()!.onDestroyed()\r\n    }\r\n    Cinnabun.removeComponentReferences(el)\r\n  }\r\n\r\n  onDestroy() {\r\n    if (this.props.onDestroyed) this.props.onDestroyed(this)\r\n  }\r\n\r\n  getParentOfType<Class extends ClassConstructor<Component>>(\r\n    classRef: Class\r\n  ): InstanceType<Class> | undefined {\r\n    if (!this.parent) return undefined\r\n\r\n    if (this.parent instanceof classRef)\r\n      return this.parent as InstanceType<Class>\r\n\r\n    //@ts-ignore (screw typescript, this is correct)\r\n    return this.parent.getParentOfType(classRef)\r\n  }\r\n\r\n  unMount() {\r\n    for (const c of this.children) {\r\n      if (c instanceof Component) c.unMount()\r\n    }\r\n    this.mounted = false\r\n  }\r\n\r\n  recursiveCall(func: { (c: Component): void }) {\r\n    func(this)\r\n    for (const c of this.children) {\r\n      if (c instanceof Component) c.recursiveCall(func)\r\n    }\r\n  }\r\n\r\n  isSVG(): boolean {\r\n    try {\r\n      return this.tag.toLowerCase() === \"svg\" || !!this.element?.closest(\"svg\")\r\n    } catch (error) {\r\n      console.error(\"isSVG ERROR\", this.element)\r\n      return false\r\n    }\r\n  }\r\n\r\n  useRequestData<T>(requestDataPath: string, fallback: T) {\r\n    return Cinnabun.isClient\r\n      ? fallback\r\n      : this.cbInstance?.getServerRequestData<T>(requestDataPath)\r\n  }\r\n}\r\n\r\nexport class FragmentComponent extends Component {\r\n  constructor(children: ComponentChild[] = []) {\r\n    super(\"\", { children })\r\n  }\r\n}\r\n\r\nexport class ForComponent<T> extends Component {\r\n  constructor(items: Signal<T[]> | T[], mapPredicate: TemplateFunc<T>) {\r\n    const reactiveItems = items instanceof Signal ? items : new Signal(items)\r\n\r\n    super(\"\", {\r\n      subscription: (_, self) =>\r\n        reactiveItems.subscribe((newItems) => {\r\n          const newChildren = newItems.map(mapPredicate)\r\n          // check if all children have a key and the key is unique\r\n          // if not, we can't do partial rerendering\r\n          let uniqueKeys = true\r\n          for (const child of newChildren) {\r\n            //prettier-ignore\r\n            if (newChildren.filter((c) => c.props.key === child.props.key).length > 1) {\r\n              uniqueKeys = false\r\n              console.error(\"non-unique key found in <For/>\", child.props.key)\r\n              console.error(\r\n                \"Children of <For/> must have unique keys, and they should not be index-based - expect bugs!\"\r\n              )\r\n              break\r\n            }\r\n          }\r\n          // ssr doesn't need to worry about partial rerendering, so we can just replace the children\r\n          if (!Cinnabun.isClient) return self.replaceChildren(newChildren)\r\n          // if we have unique keys, we can do partial rerendering\r\n          if (uniqueKeys && !self.props.hydrating)\r\n            return DomInterop.diffMergeChildren(self, newChildren)\r\n          // otherwise, we have to do a full rerender\r\n          DomInterop.unRender(self)\r\n          self.replaceChildren(newChildren)\r\n          DomInterop.reRender(self)\r\n        }),\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * @description\r\n * A component that renders a list of items\r\n * @example\r\n * ```tsx\r\n * <For\r\n *   each={products}\r\n *   template={(p) => <ProductCard product={p} />}\r\n * />\r\n * ```\r\n */\r\nexport function For<T>(\r\n  { each, template }: ForProps<T>,\r\n  templateChild: [TemplateFunc<T>]\r\n): Component {\r\n  return new ForComponent<T>(each, template ?? templateChild[0])\r\n}\r\n\r\nexport class SuspenseComponent extends Component {\r\n  promiseFunc: { (): Promise<any> } | undefined\r\n  promiseInstance: Promise<any> | undefined\r\n  promiseCache: any\r\n  promiseLoading: boolean = true\r\n\r\n  constructor(\r\n    public tag: string,\r\n    props: SuspenseProps & { children: [ComponentFunc] }\r\n  ) {\r\n    super(tag, props)\r\n  }\r\n\r\n  get childArgs(): any[] {\r\n    return [this.promiseLoading, this.promiseCache]\r\n  }\r\n  resetPromise() {\r\n    this.promiseLoading = true\r\n    this.promiseFunc = undefined\r\n    this.promiseCache = undefined\r\n  }\r\n  handlePromise(\r\n    onfulfilled?: ((value: any) => void | PromiseLike<void>) | null | undefined,\r\n    onrejected?: ((reason: any) => PromiseLike<never>) | null | undefined\r\n  ) {\r\n    this.promiseLoading = false\r\n    if (onrejected) {\r\n      console.error(\"handlePromise() - unhandle case 'onrejected'\")\r\n      debugger //todo\r\n      return\r\n    }\r\n    this.promiseCache = onfulfilled\r\n    if (Cinnabun.isClient) {\r\n      DomInterop.unRender(this)\r\n      DomInterop.reRender(this)\r\n    }\r\n  }\r\n\r\n  setPromise(promise: { (): Promise<any> }) {\r\n    if (!this.promiseFunc && promise) {\r\n      this.promiseLoading = true\r\n      this.promiseFunc = promise\r\n      this.promiseInstance = this.promiseFunc()\r\n      this.promiseInstance.then(this.handlePromise.bind(this))\r\n    } else if (this.promiseFunc && !this.props.cache) {\r\n      this.promiseLoading = true\r\n      this.promiseInstance = this.promiseFunc()\r\n      this.promiseInstance.then(this.handlePromise.bind(this))\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * @description\r\n * A component that renders a fallback while waiting for a promise to resolve\r\n * @example\r\n * ```tsx\r\n * <Suspense promise={fetchData}>\r\n *  {(loading, data) => {\r\n *   if (loading) return <Loading />\r\n *    return <YourComponent data={data} />\r\n *  }}\r\n * </Suspense>\r\n * ```\r\n */\r\nexport const Suspense = (\r\n  { promise, cache, ...rest }: SuspenseProps,\r\n  children: [ComponentFunc]\r\n) => {\r\n  return new SuspenseComponent(\"\", { promise, cache, children, ...rest })\r\n}\r\n", "import { Cinnabun } from \"./cinnabun\"\r\nimport { Component, FragmentComponent } from \"./component\"\r\nimport { ComponentChildren } from \"./types\"\r\n\r\nconst portalRoots: Record<string, Component> = {}\r\n\r\nexport const createPortal = (children: ComponentChildren, rootId: string) => {\r\n  if (!Cinnabun.isClient) return new FragmentComponent()\r\n\r\n  if (portalRoots[rootId]) {\r\n    for (const c of children) {\r\n      if (!c) continue\r\n      portalRoots[rootId].appendChildren(c)\r\n    }\r\n    return portalRoots[rootId]\r\n  }\r\n\r\n  const element = document.getElementById(rootId)\r\n  if (!element) throw new Error(`Element with id ${rootId} not found`)\r\n\r\n  const res = Object.assign(new Component(element.tagName, { children }), {\r\n    element,\r\n    isStatic: true,\r\n  })\r\n  portalRoots[rootId] = res\r\n  return res\r\n}\r\n", "export { Component, For, Suspense } from \"./component\"\r\nexport { Signal, createSignal, computed } from \"./signal\"\r\nexport { createPortal } from \"./portal\"\r\nexport { useRef } from \"./ref\"\r\n\r\nimport { FragmentComponent, Component } from \"./component\"\r\nimport { ComponentChildren, ComponentProps, JSXProps, Tag } from \"./types\"\r\n\r\ndeclare global {\r\n  namespace JSX {\r\n    interface IntrinsicElements {\r\n      [key: string]: Partial<ComponentProps>\r\n    }\r\n  }\r\n}\r\n\r\nexport const h = (\r\n  tag: Tag,\r\n  props: JSXProps,\r\n  ...children: ComponentChildren\r\n) => {\r\n  if (typeof tag === \"function\") {\r\n    return tag({ ...props, children }, children)\r\n  }\r\n\r\n  let p = props ? props : ({} as ComponentProps)\r\n\r\n  p.children = children\r\n\r\n  return new Component(tag, p)\r\n}\r\n\r\nexport function fragment(_: any, children: ComponentChildren) {\r\n  return new FragmentComponent(children)\r\n}\r\n", "import { Component } from \".\"\r\nimport { DomInterop } from \"./domInterop\"\r\nimport { ClassConstructor, WatchedElementRef } from \"./types\"\r\nexport { h, fragment } from \".\"\r\n\r\nexport type RuntimeService<Class> = InstanceType<ClassConstructor<Class>>\r\n\r\ntype ServerRequestData = {\r\n  path: string\r\n  data: {\r\n    [key: string]: any\r\n  }\r\n}\r\n\r\nexport class Cinnabun {\r\n  static readonly DEBUG_COMPONENT_REFCOUNT = false\r\n  static readonly isClient: boolean = \"window\" in globalThis\r\n\r\n  //client singleton\r\n  static rootMap: Map<Element | ChildNode, number> = new Map()\r\n  static componentReferences: WatchedElementRef[] = []\r\n  static runtimeServices: RuntimeService<any>[] = []\r\n\r\n  //ssr instance\r\n  private serverComponentReferences: WatchedElementRef[] = []\r\n  private serverRequest: ServerRequestData = {\r\n    path: \"/\",\r\n    data: {},\r\n  }\r\n\r\n  setServerRequestData(data: ServerRequestData) {\r\n    this.serverRequest = data\r\n  }\r\n\r\n  getServerRequestData<T>(keysPath: string): T | undefined {\r\n    const props = keysPath.split(\".\")\r\n    let value: any = { ...this.serverRequest }\r\n    for (let i = 0; i < props.length; i++) {\r\n      value = value[props[i]] as T | undefined\r\n      if (value === undefined) {\r\n        return undefined\r\n      }\r\n    }\r\n    return value as T | undefined\r\n  }\r\n\r\n  static bake(app: Component, root: HTMLElement): void {\r\n    const tray = new Component(root.tagName, {\r\n      children: [app],\r\n    })\r\n    tray.element = root\r\n    DomInterop.render(tray)\r\n  }\r\n\r\n  static getComponentReferences(component: Component) {\r\n    return Cinnabun.isClient\r\n      ? Cinnabun.componentReferences\r\n      : component.cbInstance!.serverComponentReferences\r\n  }\r\n\r\n  static removeComponentReferences(component: Component) {\r\n    Cinnabun.removeComponentChildReferences(component)\r\n\r\n    if (Cinnabun.isClient) {\r\n      Cinnabun.componentReferences = Cinnabun.componentReferences.filter(\r\n        (c) => c.component !== component\r\n      )\r\n    } else {\r\n      component.cbInstance!.serverComponentReferences =\r\n        component.cbInstance!.serverComponentReferences.filter(\r\n          (c) => c.component !== component\r\n        )\r\n    }\r\n    if (Cinnabun.DEBUG_COMPONENT_REFCOUNT)\r\n      Cinnabun.logComponentRefCount(component)\r\n  }\r\n\r\n  static removeComponentChildReferences(component: Component) {\r\n    for (const c of component.children) {\r\n      if (c instanceof Component) Cinnabun.removeComponentReferences(c)\r\n    }\r\n  }\r\n\r\n  static addComponentReference = (ref: WatchedElementRef) => {\r\n    if (Cinnabun.isClient) {\r\n      Cinnabun.componentReferences.push(ref)\r\n    } else {\r\n      ref.component.cbInstance!.serverComponentReferences.push(ref)\r\n    }\r\n\r\n    if (Cinnabun.DEBUG_COMPONENT_REFCOUNT)\r\n      Cinnabun.logComponentRefCount(ref.component)\r\n  }\r\n\r\n  static logComponentRefCount(component: Component) {\r\n    console.debug(\r\n      \"~~ CB REF COUNT\",\r\n      Cinnabun.isClient\r\n        ? Cinnabun.componentReferences.length\r\n        : component.cbInstance!.serverComponentReferences.length,\r\n      performance.now()\r\n    )\r\n  }\r\n\r\n  static registerRuntimeServices<Class>(...services: RuntimeService<Class>[]) {\r\n    Cinnabun.runtimeServices.push(...services)\r\n  }\r\n\r\n  static getRuntimeService<Class extends ClassConstructor<any>>(\r\n    classRef: Class\r\n  ): InstanceType<Class> {\r\n    return Cinnabun.runtimeServices.find((s) => {\r\n      return s instanceof classRef\r\n    })\r\n  }\r\n}\r\n", "import { Writable } from \"stream\"\r\nimport { Cinnabun } from \"./cinnabun\"\r\nimport { Component, FragmentComponent } from \"./component\"\r\nimport { Signal } from \"./signal\"\r\nimport { ComponentProps, SerializedComponent } from \"./types\"\r\nimport { generateUUID, validHtmlProps } from \"./utils\"\r\n\r\nexport type ServerPromise<T> = Promise<T>\r\n\r\ntype ServerBakeResult = {\r\n  componentTree: SerializedComponent\r\n  html: string\r\n}\r\n\r\ntype PromiseQueueItem = {\r\n  promise: Promise<any>\r\n  callback: { (data: any): Promise<void> }\r\n}\r\ntype Accumulator = {\r\n  promiseQueue: PromiseQueueItem[]\r\n  html: string\r\n}\r\n\r\nexport type SSRConfig = {\r\n  cinnabunInstance: Cinnabun\r\n  stream: Writable | null\r\n}\r\n\r\nexport class SSR {\r\n  static deferredLoaderPrefix = \"cb-deferred-loader\"\r\n  static deferralEvtName = \"deferral-complete\"\r\n  static deferralScriptIdPrefix = \"deferral-\"\r\n\r\n  static async serverBake(\r\n    app: Component,\r\n    config: SSRConfig\r\n  ): Promise<ServerBakeResult> {\r\n    let startTime = 0\r\n    if (process.env.DEBUG) startTime = performance.now()\r\n    const accumulator: Accumulator = {\r\n      promiseQueue: [],\r\n      html: \"\",\r\n    }\r\n\r\n    const serialized = await SSR.serialize(accumulator, app, config)\r\n    if (process.env.DEBUG) {\r\n      const renderTime = Number(performance.now() - startTime).toFixed(3)\r\n      console.log(\r\n        `${config.cinnabunInstance.getServerRequestData<string>(\"path\")} | render time: ${renderTime}ms`\r\n      )\r\n    }\r\n\r\n    SSR.render(\r\n      `<script id=\"server-props\">window.__cbData={root:document.documentElement,component:${JSON.stringify(\r\n        { children: [serialized], props: {} }\r\n      )}}</script><script src=\"/static/index.js\" type=\"module\"></script>`,\r\n      config,\r\n      accumulator\r\n    )\r\n\r\n    if (accumulator.promiseQueue.length) {\r\n      await Promise.allSettled(\r\n        accumulator.promiseQueue.map(async (item) => {\r\n          const data = await item.promise\r\n          return item.callback(data)\r\n        })\r\n      )\r\n    }\r\n\r\n    return {\r\n      componentTree: { children: [serialized], props: {} },\r\n      html: accumulator.html,\r\n    }\r\n  }\r\n\r\n  public static serializePropName(val: string): string {\r\n    switch (val) {\r\n      case \"className\":\r\n        return \"class\"\r\n      default:\r\n        return val\r\n    }\r\n  }\r\n\r\n  public static serializeProps(component: Component): Partial<ComponentProps> {\r\n    return validHtmlProps(component.props)\r\n  }\r\n\r\n  public static async serialize(\r\n    accumulator: Accumulator,\r\n    component: Component,\r\n    config: SSRConfig\r\n  ): Promise<SerializedComponent> {\r\n    component.cbInstance = config.cinnabunInstance\r\n    component.applyBindProps()\r\n\r\n    const res: SerializedComponent = {\r\n      props: SSR.serializeProps(component),\r\n      children: [],\r\n    }\r\n\r\n    const {\r\n      children,\r\n      onMounted,\r\n      onBeforeUnmounted,\r\n      onBeforeServerRendered,\r\n      subscription,\r\n      promise,\r\n      prefetch,\r\n      visible,\r\n      watch,\r\n      ...rest\r\n    } = component.props\r\n\r\n    const shouldRender = component.shouldRender()\r\n\r\n    if (shouldRender && subscription) component.subscribeTo(subscription)\r\n    if (shouldRender && onBeforeServerRendered) {\r\n      await onBeforeServerRendered(component)\r\n    }\r\n\r\n    if (!shouldRender || !component.tag) {\r\n      if (shouldRender) {\r\n        const children = await SSR.serializeChildren(\r\n          accumulator,\r\n          component,\r\n          shouldRender,\r\n          config\r\n        )\r\n        return {\r\n          props: SSR.serializeProps(component),\r\n          children,\r\n        }\r\n      }\r\n      return res\r\n    }\r\n\r\n    res.tag = component.tag\r\n\r\n    const renderClosingTag =\r\n      [\"br\", \"hr\", \"img\", \"input\", \"link\", \"meta\"].indexOf(\r\n        component.tag.toLowerCase()\r\n      ) === -1\r\n\r\n    const html = `<${component.tag}${Object.entries(rest ?? {})\r\n      .filter(([k, v]) => {\r\n        if (k === \"style\" && typeof v !== \"string\") return false\r\n        return !k.startsWith(\"bind:\") && !k.startsWith(\"on\")\r\n      })\r\n      .map(\r\n        ([k, v]) =>\r\n          ` ${SSR.serializePropName(k)}=\"${component.getPrimitive(v)}\"`\r\n      )\r\n      .join(\"\")}${renderClosingTag ? \"\" : \"/\"}>`\r\n\r\n    SSR.render(html, config, accumulator)\r\n\r\n    res.children = await SSR.serializeChildren(\r\n      accumulator,\r\n      component,\r\n      shouldRender,\r\n      config\r\n    )\r\n\r\n    if (renderClosingTag) {\r\n      SSR.render(`</${component.tag}>`, config, accumulator)\r\n    }\r\n    return res\r\n  }\r\n\r\n  static render(content: string, config: SSRConfig, accumulator: Accumulator) {\r\n    if (!config.stream) {\r\n      accumulator.html += content\r\n      return\r\n    }\r\n    config.stream.write(content)\r\n  }\r\n\r\n  public static async serializeChildren(\r\n    accumulator: Accumulator,\r\n    component: Component,\r\n    shouldRender: boolean,\r\n    config: SSRConfig\r\n  ): Promise<(SerializedComponent | string)[]> {\r\n    const res: (SerializedComponent | string)[] = []\r\n    // suspense prefetching\r\n    if (shouldRender) {\r\n      const promise = component.props.promise as { (): Promise<any> }\r\n      if (component.props.prefetch && \"promiseCache\" in component) {\r\n        component.promiseCache = await promise()\r\n        component.props.promiseCache = component.promiseCache\r\n        if (\"promiseLoading\" in component) component.promiseLoading = false\r\n      } else if (\r\n        component.props[\"prefetch:defer\"] &&\r\n        \"promiseCache\" in component\r\n      ) {\r\n        if (!component.promiseCache) {\r\n          component.props[\"cb-deferralId\"] = generateUUID()\r\n          SSR.render(\r\n            `<!--${SSR.deferredLoaderPrefix}:${component.props[\"cb-deferralId\"]}-->`,\r\n            config,\r\n            accumulator\r\n          )\r\n          accumulator.promiseQueue.push({\r\n            promise: promise(),\r\n            callback: async (data) => {\r\n              component.promiseCache = data\r\n              //await SSR.serialize(accumulator, component, config)\r\n              const deferralId = component.props[\"cb-deferralId\"]\r\n              SSR.render(\r\n                `<script type=\"module\" id=\"${\r\n                  SSR.deferralScriptIdPrefix\r\n                }${deferralId}\">document.dispatchEvent(new CustomEvent(\"${\r\n                  SSR.deferralEvtName\r\n                }\",{\r\n            bubbles:true,\r\n            detail: {\r\n              deferralId: \"${deferralId}\",\r\n              data: ${JSON.stringify(data)}\r\n            }\r\n          }))\r\n          </script>`,\r\n                config,\r\n                accumulator\r\n              )\r\n            },\r\n          })\r\n        }\r\n      }\r\n    }\r\n\r\n    for await (const c of component.children) {\r\n      if (typeof c === \"string\" || typeof c === \"number\") {\r\n        if (shouldRender) SSR.render(c.toString(), config, accumulator)\r\n        res.push(c.toString())\r\n        continue\r\n      }\r\n\r\n      if (c instanceof Signal) {\r\n        if (shouldRender) SSR.render(c.value.toString(), config, accumulator)\r\n        res.push(c.value.toString())\r\n        continue\r\n      }\r\n      if (typeof c === \"object\" && !(c instanceof Component)) {\r\n        //just a safety thing, so we see '[Object object]' in the frontend\r\n        //instead of crashing from trying to serialize the object as a component\r\n\r\n        //@ts-ignore\r\n        const stringified = JSON.stringify(c)\r\n        if (shouldRender) SSR.render(stringified, config, accumulator)\r\n        res.push(stringified)\r\n        continue\r\n      }\r\n      if (typeof c === \"function\") {\r\n        try {\r\n          let val = c(...component.childArgs)\r\n          if (Array.isArray(val)) val = new FragmentComponent(val)\r\n          if (val instanceof Component) {\r\n            val.parent = component\r\n            const sc = await SSR.serialize(accumulator, val, config)\r\n            res.push(sc)\r\n            continue\r\n          } else if (typeof val === \"string\" || typeof val === \"number\") {\r\n            if (shouldRender) SSR.render(val.toString(), config, accumulator)\r\n            res.push(val.toString())\r\n            continue\r\n          }\r\n        } catch (error) {\r\n          console.error(error)\r\n        }\r\n\r\n        continue\r\n      }\r\n\r\n      const sc = await SSR.serialize(accumulator, c, config)\r\n      res.push(sc)\r\n    }\r\n    return res\r\n  }\r\n}\r\n", "import { Cinnabun } from \"./cinnabun\"\r\nimport { Component, FragmentComponent, SuspenseComponent } from \"./component\"\r\nimport { DomInterop } from \"./domInterop\"\r\nimport { Signal } from \"./signal\"\r\nimport { SSR } from \"./ssr\"\r\nimport {\r\n  SSRProps,\r\n  ComponentChild,\r\n  SerializedComponent,\r\n  LazyComponentModule,\r\n  ComponentProps,\r\n} from \"./types\"\r\n\r\nexport class Hydration {\r\n  static validate(component: Component) {\r\n    if (component.tag && component.shouldRender()) {\r\n      const hasElement = component.element\r\n      const elementMatchesTag =\r\n        hasElement &&\r\n        component.element?.tagName.toLowerCase() === component.tag.toLowerCase()\r\n\r\n      if (!elementMatchesTag)\r\n        console.error(\"component hydration failed\", component)\r\n    }\r\n    for (const c of component.children) {\r\n      if (c instanceof Component) Hydration.validate(c)\r\n    }\r\n  }\r\n  static hydrate(app: Component, ssrProps: SSRProps) {\r\n    console.log(\"hydrating\", ssrProps)\r\n    console.time(\"hydration time\")\r\n\r\n    const tray = new Component(ssrProps.root.tagName)\r\n    tray.element = ssrProps.root\r\n    tray.children = [app]\r\n\r\n    Hydration.hydrateComponent(\r\n      tray,\r\n      app,\r\n      ssrProps.component.children[0] as SerializedComponent,\r\n      ssrProps.root\r\n    )\r\n\r\n    console.timeEnd(\"hydration time\")\r\n    console.log(\"hydrated\", tray)\r\n\r\n    // hydration validation breaks with streaming,\r\n    // something to do with the way the browser parses the viewport meta tag \uD83D\uDE22\r\n\r\n    Hydration.validate(tray)\r\n  }\r\n\r\n  static async lazyHydrate(\r\n    suspenseWrapper: SuspenseComponent,\r\n    modulePromise: LazyComponentModule,\r\n    props?: Partial<ComponentProps>\r\n  ) {\r\n    const module = await modulePromise\r\n    const component = module.default(props)\r\n    component.parent = suspenseWrapper\r\n    const { element } = DomInterop.getMountLocation(component)\r\n    if (!element) return\r\n\r\n    suspenseWrapper.funcComponents.push(component)\r\n    Hydration.hydrateComponent(\r\n      suspenseWrapper,\r\n      component,\r\n      {} as SerializedComponent,\r\n      element\r\n    )\r\n    DomInterop.reRender(component)\r\n  }\r\n\r\n  static hydrateComponent(\r\n    parent: Component,\r\n    c: ComponentChild,\r\n    sc: SerializedComponent,\r\n    parentElement: Element | ChildNode\r\n  ) {\r\n    if (!c) return\r\n\r\n    if (typeof c === \"string\" || typeof c === \"number\" || c instanceof Signal) {\r\n      Hydration.updateParentOffset(parentElement, 1)\r\n      return\r\n    }\r\n    if (typeof c === \"function\") {\r\n      const usePromiseCache =\r\n        \"promiseCache\" in parent.props &&\r\n        (parent.props.prefetch || parent.props[\"prefetch:defer\"])\r\n\r\n      let val = usePromiseCache\r\n        ? c(...[false, parent.props.promiseCache])\r\n        : c(...parent.childArgs)\r\n\r\n      if (Array.isArray(val)) val = new FragmentComponent(val)\r\n      if (val instanceof Component) {\r\n        if (!val.shouldRender()) return\r\n        DomInterop.removeFuncComponents(parent)\r\n        Hydration.hydrateComponent(parent, val, sc, parentElement)\r\n        parent.funcComponents.push(val)\r\n      }\r\n\r\n      return\r\n    }\r\n\r\n    //if (c.tag.toLowerCase() === \"article\") debugger\r\n\r\n    c.props.hydrating = true\r\n    c.parent = parent\r\n\r\n    if (sc?.props && Object.keys(sc.props).length) {\r\n      for (const [k, v] of Object.entries(sc.props)) {\r\n        const curProp = c.props[k]\r\n        if (curProp instanceof Signal) continue\r\n        c.props[k] = v\r\n      }\r\n    }\r\n    if (sc?.children && sc.children.length > 0 && c.children.length === 0) {\r\n      const serializedChildrenWithKeys = sc.children.filter(\r\n        (c) => typeof c === \"object\" && c.props.key\r\n      )\r\n      for (let i = 0; i < serializedChildrenWithKeys.length; i++) {\r\n        const sChild = serializedChildrenWithKeys[i] as SerializedComponent\r\n        if (\r\n          !c.children.find(\r\n            (child) =>\r\n              child instanceof Component && child.props.key === sChild.props.key\r\n          )\r\n        ) {\r\n          const newChild = Hydration.createKeyNodeChild(\r\n            sChild,\r\n            parentElement as HTMLElement\r\n          )\r\n          if (!newChild) continue\r\n          newChild.parent = c\r\n          c.children.push(newChild)\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!c.shouldRender()) return\r\n\r\n    if (c.tag && !c.element) {\r\n      const offset = Hydration.getParentOffset(parentElement)\r\n      let node = parentElement.childNodes[offset]\r\n      try {\r\n        if (!node) {\r\n          DomInterop.reRender(c)\r\n          return\r\n        }\r\n        if (\r\n          node.nodeType === Node.COMMENT_NODE &&\r\n          node.nodeValue?.includes(SSR.deferredLoaderPrefix)\r\n        ) {\r\n          const comment = node\r\n          node = node.nextSibling!\r\n          comment.parentNode?.removeChild(comment)\r\n          Hydration.handleDeferral(parent, node)\r\n        }\r\n      } catch (error) {\r\n        console.error(error, node)\r\n        debugger\r\n      }\r\n      c.element = node as HTMLElement\r\n      Hydration.updateParentOffset(parentElement, 1)\r\n      DomInterop.updateElement(c)\r\n    }\r\n\r\n    if (c.props.subscription) c.subscribeTo(c.props.subscription)\r\n    if (\r\n      c.props.promise &&\r\n      \"setPromise\" in c &&\r\n      typeof c.setPromise === \"function\" &&\r\n      !c.props.prefetch &&\r\n      !c.props[\"prefetch:defer\"]\r\n    )\r\n      c.setPromise(c.props.promise)\r\n\r\n    for (let i = 0; i < c.children.length; i++) {\r\n      const child = c.children[i]\r\n      const sChild = sc?.children ? sc.children[i] : ({} as SerializedComponent)\r\n\r\n      if (child instanceof Signal) {\r\n        DomInterop.renderChild(c, child, i)\r\n      }\r\n      if (typeof sChild === \"string\" || typeof sChild === \"number\") {\r\n        const el = c.element ?? parentElement\r\n        Hydration.updateParentOffset(el, 1)\r\n        continue\r\n      }\r\n\r\n      Hydration.hydrateComponent(c, child, sChild, c.element ?? parentElement)\r\n    }\r\n    c.mounted = true\r\n    c.props.hydrating = false\r\n  }\r\n\r\n  static handleDeferral(parent: Component, node: ChildNode) {\r\n    const handleDeferredContentArrival = (evt: Event) => {\r\n      const { deferralId, data } = (evt as CustomEvent).detail as {\r\n        deferralId: string\r\n        data: any\r\n      }\r\n      if (deferralId === parent.props[\"cb-deferralId\"]) {\r\n        const evtScript = document.getElementById(\r\n          `${SSR.deferralScriptIdPrefix}${deferralId}`\r\n        )\r\n        if (evtScript) {\r\n          const parentEl = node.parentElement!\r\n          evtScript.parentNode?.removeChild(evtScript)\r\n          Hydration.updateParentOffset(parentEl, -1)\r\n          parentEl.removeChild(node)\r\n\r\n          if (\"promiseCache\" in parent) {\r\n            parent.promiseCache = data\r\n            if (\"promiseLoading\" in parent) parent.promiseLoading = false\r\n          }\r\n          DomInterop.reRender(parent)\r\n        }\r\n      }\r\n      window.removeEventListener(\r\n        SSR.deferralEvtName,\r\n        handleDeferredContentArrival\r\n      )\r\n    }\r\n    window.addEventListener(SSR.deferralEvtName, handleDeferredContentArrival)\r\n  }\r\n\r\n  static updateParentOffset(parentElement: Element | ChildNode, n: number) {\r\n    Cinnabun.rootMap.set(\r\n      parentElement,\r\n      Hydration.getParentOffset(parentElement) + n\r\n    )\r\n  }\r\n\r\n  static getParentOffset(parentElement: Element | ChildNode): number {\r\n    return Cinnabun.rootMap.get(parentElement) ?? 0\r\n  }\r\n\r\n  static createComponentChild(\r\n    sc: SerializedComponent | string | number,\r\n    parentElement: HTMLElement\r\n  ): Component | string | number | undefined {\r\n    if (typeof sc === \"string\" || typeof sc === \"number\") {\r\n      return sc\r\n    }\r\n\r\n    const newComponent = new Component(sc.tag ?? \"\", { ...sc.props })\r\n    let element: HTMLElement | undefined\r\n    if (newComponent.tag) {\r\n      const offset = Hydration.getParentOffset(parentElement) ?? 0\r\n      element = parentElement.childNodes[offset] as HTMLElement\r\n    }\r\n    if (element) {\r\n      newComponent.element = element\r\n      Hydration.updateParentOffset(parentElement, 1)\r\n    }\r\n    for (const c of sc.children) {\r\n      const child = Hydration.createComponentChild(c, element ?? parentElement)\r\n      if (child) newComponent.children.push(child)\r\n    }\r\n    return newComponent\r\n  }\r\n  static createKeyNodeChild(\r\n    sc: SerializedComponent,\r\n    parentElement: HTMLElement\r\n  ): Component | undefined {\r\n    if (typeof sc === \"string\" || typeof sc === \"number\") {\r\n      return sc\r\n    }\r\n    const newComponent = new Component(sc.tag ?? \"\", { ...sc.props })\r\n    if (newComponent.tag) {\r\n      const element = Array.from(parentElement.childNodes).find(\r\n        (cn) =>\r\n          cn instanceof HTMLElement &&\r\n          cn.tagName.toLowerCase() === sc.tag?.toLowerCase() &&\r\n          cn.getAttribute(\"key\")!.toString() === sc.props.key.toString()\r\n      )\r\n      if (element) {\r\n        newComponent.element = element as HTMLElement\r\n      } else {\r\n        console.error(\"failed to acquire element for\", sc)\r\n        return undefined\r\n      }\r\n    }\r\n\r\n    return newComponent\r\n  }\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\nimport { type Component } from \"cinnabun\"\n\nexport const Document = (App: { (): Component }) => {\n  return (\n    <>\n      <head>\n        <meta charset=\"utf-8\" />\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" />\n        <title>SSR App</title>\n        <link rel=\"stylesheet\" href=\"/static/index.css\" />\n      </head>\n\n      <body>\n        <div id=\"app\">\n          <App />\n        </div>\n        <div id=\"portal-root\"></div>\n      </body>\n    </>\n  )\n}\n", "import { matchPath } from \".\"\r\nimport { Signal, Component } from \"..\"\r\nimport { Cinnabun } from \"../cinnabun\"\r\nimport { DomInterop } from \"../domInterop\"\r\nimport { ComponentChild, PropsSetter, RouteProps } from \"../types\"\r\n\r\nexport class RouteComponent extends Component {\r\n  constructor(path: string, component: ComponentChild) {\r\n    super(\"\", {\r\n      path,\r\n      pathDepth: path.split(\"\").filter((chr) => chr === \"/\").length,\r\n      children: [component],\r\n      visible: false,\r\n    })\r\n  }\r\n\r\n  get childArgs() {\r\n    return [{ params: this.props.params, query: this.props.query }]\r\n  }\r\n}\r\n\r\nexport class RouterComponent extends Component {\r\n  constructor(store: Signal<string>, children: RouteComponent[]) {\r\n    if (children.some((c) => !(c instanceof RouteComponent)))\r\n      throw new Error(\"Must provide Route as child of Router\")\r\n\r\n    if (Cinnabun.isClient) {\r\n      window.addEventListener(\"popstate\", (e) => {\r\n        store.value = (e.target as Window)?.location.pathname ?? \"/\"\r\n      })\r\n    }\r\n    // Sort children by path depth so that the most specific path is matched first\r\n    children.sort((a, b) => {\r\n      return (\r\n        (b as RouteComponent).props.pathDepth -\r\n        (a as RouteComponent).props.pathDepth\r\n      )\r\n    })\r\n\r\n    const subscription = (_: PropsSetter, self: Component) => {\r\n      return store.subscribe((val) => {\r\n        for (const c of self.children as RouteComponent[]) {\r\n          if (Cinnabun.isClient && c.props.visible) DomInterop.unRender(c)\r\n          c.props.visible = false\r\n          c.props.params = {}\r\n        }\r\n\r\n        let nextRoute: RouteComponent | undefined = undefined\r\n        for (let i = 0; i < self.children.length; i++) {\r\n          const c = self.children[i] as RouteComponent\r\n          const matchRes = (self as RouterComponent).matchRoute(\r\n            c,\r\n            this.useRequestData<string>(\"path\", val)!\r\n          )\r\n          if (matchRes.routeMatch) {\r\n            nextRoute = c\r\n            c.props.visible = !!matchRes.routeMatch\r\n            c.props.params = matchRes.params ?? {}\r\n            c.props.query = matchRes.query ?? {}\r\n            break\r\n          }\r\n        }\r\n        if (Cinnabun.isClient && self.mounted && nextRoute)\r\n          DomInterop.reRender(nextRoute)\r\n      })\r\n    }\r\n\r\n    super(\"\", { subscription, children })\r\n  }\r\n\r\n  getParentPath() {\r\n    let parentPath = \"\"\r\n    let parentRoute = this.getParentOfType(RouteComponent)\r\n\r\n    while (parentRoute) {\r\n      parentPath = parentRoute.props.path + parentPath\r\n      parentRoute = parentRoute.getParentOfType(RouteComponent)\r\n    }\r\n    return parentPath\r\n  }\r\n\r\n  matchRoute(\r\n    c: RouteComponent,\r\n    path: string\r\n  ): {\r\n    params: any\r\n    query: any\r\n    routeMatch: RegExpMatchArray | null\r\n  } {\r\n    const cPath: string = this.getParentPath() + c.props.path\r\n\r\n    return matchPath(path, cPath)\r\n  }\r\n}\r\n\r\nexport const Route = ({ path, component }: RouteProps) => {\r\n  return new RouteComponent(path, component)\r\n}\r\n\r\nexport const Router = (\r\n  { store }: { store: Signal<string> },\r\n  children: RouteComponent[]\r\n) => {\r\n  return new RouterComponent(store, children)\r\n}\r\n", "import { LinkProps } from \"../types\"\r\nimport { Component, Signal } from \"..\"\r\nimport { Cinnabun } from \"../cinnabun\"\r\nimport { matchPath } from \"../router\"\r\n\r\nexport const setHash = (store: Signal<string>, newHash: string) => {\r\n  if (store.value === newHash) return\r\n  window.location.hash = newHash\r\n  store.value = newHash\r\n}\r\n\r\nexport const setPath = (\r\n  store: Signal<string>,\r\n  newPath: string,\r\n  replace: boolean = false\r\n) => {\r\n  if (window.location.pathname === newPath) return\r\n  if (replace) {\r\n    window.history.replaceState({}, \"\", newPath)\r\n  } else {\r\n    window.history.pushState({}, \"\", newPath)\r\n  }\r\n  store.value = newPath\r\n}\r\n\r\nexport const Link = (props: LinkProps, children: Component[]) => {\r\n  const {\r\n    to,\r\n    store,\r\n    className,\r\n    activeClass,\r\n    useHash,\r\n    onBeforeNavigate,\r\n    ...rest\r\n  } = props\r\n\r\n  const onclick = (e: MouseEvent) => {\r\n    e.preventDefault()\r\n    if (onBeforeNavigate && !onBeforeNavigate()) return\r\n    if (useHash) return setHash(store, to)\r\n    setPath(store, to)\r\n  }\r\n\r\n  return new Component(\"a\", {\r\n    watch: store,\r\n    [\"bind:className\"]: (self: Component) => {\r\n      const curPath = Cinnabun.isClient\r\n        ? store.value\r\n        : self.cbInstance?.getServerRequestData<string>(\"path\")\r\n\r\n      const pathMatches = !!matchPath(curPath ?? \"/\", to).routeMatch\r\n\r\n      return (\r\n        className ?? \"\" + \" \" + (pathMatches ? activeClass ?? \"active\" : \"\")\r\n      )\r\n    },\r\n    href: to,\r\n    onclick,\r\n    children,\r\n    ...rest,\r\n  })\r\n}\r\n", "export * from \"./router\"\r\nexport * from \"./link\"\r\nexport * from \"./generated\"\r\n\r\nexport function matchPath(\r\n  path: string,\r\n  location: string\r\n): {\r\n  params: any\r\n  query: any\r\n  routeMatch: RegExpMatchArray | null\r\n} {\r\n  let paramNames: any[] = []\r\n  let query: any = {}\r\n\r\n  const cPath: string = location\r\n  let regexPath =\r\n    cPath.replace(/([:*])(\\w+)/g, (_full, _colon, name) => {\r\n      paramNames.push(name)\r\n      return \"([^/]+)\"\r\n    }) + \"(?:/|$)\"\r\n\r\n  // match query params\r\n  const queryMatch = path.match(/\\?(.*)/)\r\n  if (queryMatch) {\r\n    query = queryMatch[1].split(\"&\").reduce((str, value) => {\r\n      if (str === null) query = {}\r\n      const [key, val] = value.split(\"=\")\r\n      query[key] = val\r\n      return query\r\n    }, null)\r\n  }\r\n\r\n  let params: any = {}\r\n  let routeMatch = path.match(new RegExp(regexPath))\r\n  if (routeMatch !== null) {\r\n    params = routeMatch.slice(1).reduce((str, value, index) => {\r\n      if (str === null) params = {}\r\n      params[paramNames[index]] = value.split(\"?\")[0] // ensure no query params\r\n      return params\r\n    }, null)\r\n  }\r\n  return { params, query, routeMatch }\r\n}\r\n", "import { Cinnabun, Component, createSignal } from \"cinnabun\"\r\nimport { PublicUser } from \"../types/user\"\r\nimport { AuthModalCallback } from \"../types/auth\"\r\n\r\nconst isClient = Cinnabun.isClient\r\n\r\nexport const pathStore = createSignal(isClient ? window.location.pathname : \"/\")\r\n\r\nconst decodeCookie = (str: string) =>\r\n  str\r\n    .split(\";\")\r\n    .map((v) => v.split(\"=\"))\r\n    .reduce((acc, v) => {\r\n      acc[decodeURIComponent(v[0].trim())] = decodeURIComponent(v[1].trim())\r\n      return acc\r\n    }, {} as Record<string, any>)\r\n\r\nconst getUserDataFromCookie = (): PublicUser | null => {\r\n  if (!window.document.cookie) return null\r\n  const { user } = decodeCookie(window.document.cookie)\r\n  if (!user) return null\r\n  const parsed = JSON.parse(user)\r\n  return parsed ?? null\r\n}\r\n\r\nexport const userStore = createSignal<PublicUser | null>(isClient ? getUserDataFromCookie() : null)\r\n//userStore.subscribe(console.log)\r\n\r\nexport const getUser = (self: Component) =>\r\n  self.useRequestData<PublicUser | null>(\"data.user\", userStore.value)\r\n\r\nexport const isAuthenticated = (self: Component) => !!getUser(self)\r\nexport const isNotAuthenticated = (self: Component) => !getUser(self)\r\n\r\nexport const authModalOpen = createSignal(false)\r\nexport const authModalState = createSignal({\r\n  title: \"\",\r\n  message: \"\",\r\n  callbackAction: undefined as AuthModalCallback | undefined,\r\n})\r\n\r\nexport const sidebarOpen = createSignal(false)\r\nexport const userDropdownOpen = createSignal(false)\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\n\r\nexport const UserIcon = (props: ComponentProps) => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      {...props}\r\n    >\r\n      <path d=\"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2\" />\r\n      <circle cx=\"12\" cy=\"7\" r=\"4\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import { Cinnabun, Component } from \"cinnabun\"\r\nimport { TransitionProperty } from \"./types\"\r\n\r\ntype UseTransitionProps = {\r\n  onMounted: (self: Component) => void\r\n  onBeforeUnmounted: (self: Component) => Promise<boolean> | boolean\r\n  initialStyle: string\r\n}\r\nexport const useTransition = (props: {\r\n  properties: TransitionProperty[]\r\n  cancelExit?: { (): boolean }\r\n}): UseTransitionProps => {\r\n  const fromStyle = () => {\r\n    return props.properties.map((p) => `${p.name}: ${p.from}`).join(\";\")\r\n  }\r\n  const toStyle = () => {\r\n    return props.properties.map((p) => `${p.name}: ${p.to}`).join(\";\")\r\n  }\r\n\r\n  const minTransitionTime = Math.max(\r\n    ...props.properties.map((p) => p.ms ?? 300)\r\n  )\r\n\r\n  const handleMount = (self: Component) => {\r\n    if (!self.element || !Cinnabun.isClient) return\r\n    self.element.setAttribute(\"style\", `${transitionProps()};${toStyle()}`)\r\n  }\r\n  const handleBeforeUnmount = (self: Component) => {\r\n    if (!self.element || !Cinnabun.isClient) return false\r\n    self.element.setAttribute(\"style\", `${transitionProps()};${fromStyle()}`)\r\n\r\n    return new Promise<boolean>((res) => {\r\n      setTimeout(() => {\r\n        if (props.cancelExit && props.cancelExit()) {\r\n          handleMount(self)\r\n          return res(false)\r\n        }\r\n        return res(true)\r\n      }, minTransitionTime)\r\n    })\r\n  }\r\n\r\n  const transitionProps = () => {\r\n    return `transition: ${props.properties\r\n      .map((p) => `${p.name} ${p.ms ?? 300}ms`)\r\n      .join(\",\")}`\r\n  }\r\n  return {\r\n    onMounted: handleMount,\r\n    onBeforeUnmounted: handleBeforeUnmount,\r\n    initialStyle: `${transitionProps()};${fromStyle()}`,\r\n  }\r\n}\r\n", "import { Component } from \"cinnabun\"\r\nimport { PropsWithChildren } from \"cinnabun/types\"\r\nimport { TransitionProps } from \"./types\"\r\nimport { useTransition } from \"./useTransition\"\r\n\r\nexport const Transition = ({\r\n  tag = \"div\",\r\n  children,\r\n  properties,\r\n  cancelExit,\r\n  ...rest\r\n}: PropsWithChildren & TransitionProps) => {\r\n  const { onMounted, onBeforeUnmounted, initialStyle } = useTransition({\r\n    properties,\r\n    cancelExit,\r\n  })\r\n  return new Component(tag, {\r\n    children,\r\n    style: initialStyle,\r\n    onMounted,\r\n    onBeforeUnmounted,\r\n    ...rest,\r\n  })\r\n}\r\n", "import { PropsWithChildren } from \"cinnabun/types\"\r\nimport { Transition } from \"./Transition\"\r\nimport { TransitionProps } from \"./types\"\r\n\r\nexport const FadeInOut = ({\r\n  properties = [],\r\n  ...rest\r\n}: PropsWithChildren & TransitionProps) => {\r\n  properties.push({\r\n    name: \"opacity\",\r\n    from: \"0\",\r\n    to: \"1\",\r\n  })\r\n  return Transition({ ...rest, properties })\r\n}\r\n", "import { PropsWithChildren } from \"cinnabun/types\"\r\nimport { Transition } from \"./Transition\"\r\nimport { TransitionProperty, TransitionProps } from \"./types\"\r\n\r\ntype SlideDirection = \"left\" | \"top\" | \"right\" | \"bottom\"\r\ntype SlideSettings = {\r\n  from: SlideDirection\r\n  duration?: number\r\n}\r\ntype SlideProps = Partial<TransitionProps> & {\r\n  settings: SlideSettings\r\n  properties?: TransitionProperty[]\r\n  reverseExit?: boolean\r\n  absoluteExit?: boolean\r\n  unit?:\r\n    | \"%\"\r\n    | \"px\"\r\n    | \"em\"\r\n    | \"rem\"\r\n    | \"vw\"\r\n    | \"vh\"\r\n    | \"vmin\"\r\n    | \"vmax\"\r\n    | \"ex\"\r\n    | \"ch\"\r\n    | \"cm\"\r\n    | \"mm\"\r\n    | \"in\"\r\n    | \"pt\"\r\n    | \"pc\"\r\n}\r\n\r\nexport const SlideInOut = ({\r\n  settings,\r\n  properties = [],\r\n  unit = \"%\",\r\n  ...rest\r\n}: PropsWithChildren & SlideProps) => {\r\n  properties.push({\r\n    name: \"translate\",\r\n    from:\r\n      settings.from === \"bottom\"\r\n        ? `0 100${unit}`\r\n        : settings.from === \"top\"\r\n        ? `0 -100${unit}`\r\n        : settings.from === \"left\"\r\n        ? `-100${unit}`\r\n        : `100${unit}`,\r\n    to: \"0\",\r\n    ms: settings.duration ?? 300,\r\n  })\r\n  return Transition({ ...rest, properties })\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { SlideInOut } from \"cinnabun-transitions\"\r\nimport { pathStore, userDropdownOpen } from \"../state/global\"\r\nimport { Link } from \"cinnabun/router\"\r\nimport \"./UserDropdown.css\"\r\n\r\nexport const UserDropdown = () => {\r\n  return (\r\n    <div className=\"user-dropdown-wrapper\">\r\n      <SlideInOut\r\n        watch={userDropdownOpen}\r\n        bind:visible={() => userDropdownOpen.value}\r\n        settings={{ from: \"top\" }}\r\n        className=\"user-dropdown\"\r\n      >\r\n        <div className=\"user-dropdown-item\">\r\n          <Link to=\"/users/me\" store={pathStore}>\r\n            Profile\r\n          </Link>\r\n        </div>\r\n        <div className=\"user-dropdown-item\">\r\n          <Link to=\"/settings\" store={pathStore}>\r\n            Settings\r\n          </Link>\r\n        </div>\r\n        <div className=\"user-dropdown-item\">\r\n          <a href=\"/logout\">Log out</a>\r\n        </div>\r\n      </SlideInOut>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport {\r\n  authModalOpen,\r\n  authModalState,\r\n  getUser,\r\n  isAuthenticated,\r\n  isNotAuthenticated,\r\n  userDropdownOpen,\r\n  userStore,\r\n} from \"../state/global\"\r\nimport { UserIcon } from \"./icons/UserIcon\"\r\nimport { UserDropdown } from \"./UserDropdown\"\r\n\r\nexport const UserAvatar = () => {\r\n  const handleLoginClick = () => {\r\n    if (userStore.value) {\r\n      userDropdownOpen.value = !userDropdownOpen.value\r\n      return\r\n    }\r\n    authModalState.value = {\r\n      title: \"Log in\",\r\n      message: `Welcome (back?) to Zetabase - a place for\r\n       people, apache helicopters and anyone (or anything) \r\n       else that's looking for someplace better.\r\n\r\n        Try not to be a ****! Unless, of course, you\r\n        join one of the various '****' communities.`,\r\n      callbackAction: undefined,\r\n    }\r\n    authModalOpen.value = true\r\n  }\r\n  return (\r\n    <div className=\"user-area flex\">\r\n      <button\r\n        type=\"button\"\r\n        className=\"avatar-wrapper sm rounded-full border-none p-0 bg-primary-darkest\"\r\n        onclick={handleLoginClick}\r\n      >\r\n        <UserIcon className=\"avatar\" watch={userStore} bind:visible={isNotAuthenticated} />\r\n        <img\r\n          watch={userStore}\r\n          bind:visible={isAuthenticated}\r\n          bind:src={(self: Cinnabun.Component) => getUser(self)?.picture}\r\n          className=\"avatar\"\r\n          alt=\"avatar\"\r\n        />\r\n      </button>\r\n      <UserDropdown />\r\n    </div>\r\n  )\r\n}\r\n", "import { createPortal } from \"cinnabun\"\r\nimport { PropsWithChildren } from \"cinnabun/types\"\r\n\r\nexport const Portal = ({ children }: PropsWithChildren) => {\r\n  const rootId = \"portal-root\"\r\n  return createPortal(children ?? [], rootId)\r\n}\r\n", "export const generateUUID = () => {\r\n  // Public Domain/MIT\r\n  var d = new Date().getTime() //Timestamp\r\n  var d2 = (typeof performance !== \"undefined\" && performance.now && performance.now() * 1000) || 0 //Time in microseconds since page-load or 0 if unsupported\r\n  return \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\r\n    var r = Math.random() * 16 //random number between 0 and 16\r\n    if (d > 0) {\r\n      //Use timestamp until depleted\r\n      r = (d + r) % 16 | 0\r\n      d = Math.floor(d / 16)\r\n    } else {\r\n      //Use microseconds since page-load if supported\r\n      r = (d2 + r) % 16 | 0\r\n      d2 = Math.floor(d2 / 16)\r\n    }\r\n    return (c === \"x\" ? r : (r & 0x3) | 0x8).toString(16)\r\n  })\r\n}\r\n\r\nexport const truncateText = (text: string, limit: number) => {\r\n  return text.substring(0, limit) + (text.length > limit ? \"...\" : \"\")\r\n}\r\n\r\nexport const formatUTCDate = (date: string) => {\r\n  return new Date(date).toLocaleString()\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Component } from \"cinnabun\"\r\nimport \"./Notifications.css\"\r\nimport { generateUUID } from \"../utils\"\r\nimport { DomInterop } from \"cinnabun/src/domInterop\"\r\nimport { useTransition } from \"cinnabun-transitions\"\r\n\r\nexport const NotificationType = {\r\n  info: \"info\",\r\n  success: \"success\",\r\n  error: \"error\",\r\n  warning: \"warning\",\r\n}\r\n\r\ninterface INotification {\r\n  id: string\r\n  text: string\r\n  type: keyof typeof NotificationType\r\n  duration: number\r\n  component: NotificationComponent\r\n}\r\n\r\nexport const notificationStore: Record<string, INotification> = {}\r\n\r\nexport const addNotification = ({\r\n  text,\r\n  type = \"info\",\r\n  duration = 3000,\r\n}: {\r\n  text: string\r\n  type?: keyof typeof NotificationType\r\n  duration?: number\r\n}) => {\r\n  const id = generateUUID()\r\n  const notification: Partial<INotification> = {\r\n    id,\r\n    text,\r\n    type,\r\n    duration,\r\n  }\r\n  notification.component = new NotificationComponent(id, type, text)\r\n  const iNotif = notification as INotification\r\n  notificationStore[iNotif.id] = iNotif\r\n}\r\n\r\nclass NotificationComponent extends Component {\r\n  constructor(id: string, type: keyof typeof NotificationType, text: string) {\r\n    const { onMounted, onBeforeUnmounted, initialStyle } = useTransition({\r\n      properties: [\r\n        {\r\n          name: \"opacity\",\r\n          from: \"0\",\r\n          to: \"1\",\r\n        },\r\n        {\r\n          name: \"translate\",\r\n          from: \"100%\",\r\n          to: \"0%\",\r\n        },\r\n      ],\r\n    })\r\n    super(\"div\", {\r\n      [\"data-id\"]: id,\r\n      className: `notification ${type}`,\r\n      children: [text],\r\n      style: initialStyle,\r\n      onMounted,\r\n      onBeforeUnmounted,\r\n    })\r\n  }\r\n}\r\n\r\nexport class NotificationTrayComponent extends Component {\r\n  constructor(private animationDuration: number) {\r\n    super(\"div\", { className: \"notification-tray\" })\r\n\r\n    const addNotification = (notification: INotification) => {\r\n      const child = notification.component\r\n      this.prependChildren(child)\r\n      const element = child.element\r\n      element?.addEventListener(\"mouseenter\", function handler() {\r\n        child.props.hovered = true\r\n      })\r\n\r\n      element?.addEventListener(\"mouseleave\", function handler() {\r\n        child.props.hovered = false\r\n      })\r\n    }\r\n\r\n    const removeNotification = (notification: INotification) => {\r\n      const child = notification.component\r\n      child.element?.removeEventListener(\"mouseenter\", function handler() {\r\n        child.props.hovered = true\r\n      })\r\n\r\n      child.element?.removeEventListener(\"mouseleave\", function handler() {\r\n        child.props.hovered = false\r\n      })\r\n      DomInterop.unRender(child)\r\n      delete notificationStore[notification.id]\r\n    }\r\n\r\n    if (Cinnabun.Cinnabun.isClient) {\r\n      const tickRateMs = 33\r\n\r\n      setInterval(() => {\r\n        const children = this.children as NotificationComponent[]\r\n\r\n        for (const [k, notification] of Object.entries(notificationStore)) {\r\n          const c = children.find((child) => child.props[\"data-id\"] === k)\r\n          if (!c) {\r\n            addNotification(notification)\r\n          }\r\n        }\r\n        const deleteList: string[] = []\r\n        children.forEach((c) => {\r\n          if (c.props.hovered) return\r\n\r\n          const notifId: string = c.props[\"data-id\"]\r\n          const notification: INotification | undefined =\r\n            notificationStore[notifId]\r\n\r\n          if (!notification) throw new Error(\"failed to get notification\")\r\n\r\n          notification.duration -= tickRateMs\r\n\r\n          if (notification.duration <= 0) {\r\n            removeNotification(notification)\r\n            deleteList.push(notifId)\r\n          } else if (notification.duration < this.animationDuration) {\r\n            if (!c.props.hidden) {\r\n              c.props.hidden = true\r\n            }\r\n          }\r\n        })\r\n        if (deleteList.length) {\r\n          const children = this.children as NotificationComponent[]\r\n          this.children = children.filter(\r\n            (c) => !deleteList.includes(c.props[\"data-id\"])\r\n          )\r\n          for (const id of deleteList) {\r\n            delete notificationStore[id]\r\n          }\r\n        }\r\n      }, tickRateMs)\r\n    }\r\n  }\r\n}\r\n\r\nexport const NotificationTray = ({\r\n  animationDuration = 500,\r\n}: {\r\n  animationDuration?: number\r\n}) => new NotificationTrayComponent(animationDuration)\r\n", "export const API_URL = \"/api\"\r\n\r\nexport enum API_ERROR {\r\n  NOT_FOUND = \"Not found\",\r\n  NOT_AUTHENTICATED = \"Unauthenticated\",\r\n  UNAUTHORIZED = \"Unauthorized\",\r\n  FORBIDDEN = \"Forbidden\",\r\n  DISABLED = \"Disabled\",\r\n  INVALID_REQUEST = \"Invalid\",\r\n  SERVER_ERROR = \"Server error\",\r\n  COMMUNITY_NAME_NOT_AVAILABLE = \"Community name not available\",\r\n}\r\n", "import { addNotification } from \"../../components/Notifications\"\r\nimport { API_URL } from \"../../constants\"\r\nimport { Community, CommunityMember, NewCommunity } from \"../../db/schema\"\r\nimport {\r\n  CommunityData,\r\n  CommunityJoinRequestData,\r\n  CommunityListData,\r\n  CommunitySearchData,\r\n  JoinResult,\r\n  LeaveResult,\r\n} from \"../../types/community\"\r\nimport { LatestPostsData } from \"../../types/post\"\r\n\r\nexport const getCommunitySearch = async (title: string): Promise<CommunitySearchData | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/search?title=${title}`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const getCommunities = async (page = 0): Promise<CommunityListData[] | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities?page=${page}`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const getCommunity = async (id: string): Promise<Partial<CommunityData> | Error> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${id}`)\r\n    return await response.json()\r\n  } catch (error: any) {\r\n    return new Error(error.message)\r\n  }\r\n}\r\n\r\nexport const getLatestPostsCommunities = async (page = 0): Promise<LatestPostsData[] | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/latest?page=${page}`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const getCommunityJoinRequests = async (\r\n  id: string\r\n): Promise<CommunityJoinRequestData[] | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${id}/join-requests`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const respondToCommunityJoinRequest = async (\r\n  communityId: string,\r\n  requestId: string,\r\n  accepted: boolean\r\n): Promise<CommunityMember | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${communityId}/join-requests`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ requestId, accepted }),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const createCommunity = async (\r\n  community: Omit<NewCommunity, \"url_title\">\r\n): Promise<{ id: string } | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(community),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const updateCommunity = async (community: NewCommunity): Promise<Community | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${community.id}`, {\r\n      method: \"PATCH\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(community),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const joinCommunity = async (url_title: string): Promise<JoinResult | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${url_title}/join`, {\r\n      method: \"POST\",\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const leaveCommunity = async (id: string): Promise<LeaveResult | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${id}/leave`, {\r\n      method: \"POST\",\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const deleteCommunity = async (id: string): Promise<boolean> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/communities/${id}`, {\r\n      method: \"DELETE\",\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n    return true\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n    return false\r\n  }\r\n}\r\n", "import { createSignal } from \"cinnabun\"\r\nimport { ComponentFunc } from \"cinnabun/types\"\r\nimport { CommunityData, CommunityJoinRequestData } from \"../types/community\"\r\n\r\nexport const postCreatorModalOpen = createSignal(false)\r\nexport const communityCreatorModalOpen = createSignal(false)\r\nexport const communityEditorModalOpen = createSignal(false)\r\nexport const communityJoinModalOpen = createSignal(false)\r\nexport const communityLeaveModalOpen = createSignal(false)\r\nexport const communityDeleteModalOpen = createSignal(false)\r\nexport const communityOwnershipTransferModalOpen = createSignal(false)\r\n\r\nexport const selectedCommunity = createSignal<Partial<CommunityData> | null>(null)\r\nexport const selectedCommunityPost = createSignal<string | null>(null)\r\nexport const pendingCommunityJoinRequests = createSignal<CommunityJoinRequestData[]>([])\r\n\r\nexport const communityDrawerOpen = createSignal(false)\r\nexport const communityDrawerState = createSignal({\r\n  title: \"\",\r\n  componentFunc: null as ComponentFunc | null,\r\n})\r\n\r\nexport const communityRole = () => {\r\n  if (!selectedCommunity.value) return null\r\n  return selectedCommunity.value.memberType\r\n}\r\n\r\nexport const communityHasMembers = () => {\r\n  if (!selectedCommunity.value) return false\r\n  console.log(selectedCommunity.value)\r\n  return (\r\n    (selectedCommunity.value.members ?? []).length > 0 ||\r\n    (selectedCommunity.value.moderators ?? []).length > 0\r\n  )\r\n}\r\n\r\nexport const isCommunityMember = () => {\r\n  if (!selectedCommunity.value) return true\r\n  return selectedCommunity.value.memberType !== \"guest\"\r\n}\r\n\r\nexport const isCommunityOwner = () => {\r\n  return selectedCommunity.value?.memberType === \"owner\"\r\n}\r\n\r\nexport const isCommunityModerator = () => {\r\n  return selectedCommunity.value?.memberType === \"moderator\"\r\n}\r\n\r\nexport const isCommunityAdmin = () => {\r\n  return isCommunityModerator() || isCommunityOwner()\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\nimport \"./Default.css\"\r\nexport const DefaultLoader = (props: ComponentProps) => {\r\n  return (\r\n    <div className=\"lds-default\" {...props}>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { formatUTCDate } from \"../utils\"\r\nimport { Link } from \"cinnabun/router\"\r\nimport { pathStore } from \"../state/global\"\r\n\r\nexport const AuthorTag = ({\r\n  user,\r\n  date,\r\n}: {\r\n  user: {\r\n    id: string\r\n    name: string\r\n    avatarUrl: string | undefined | null\r\n  }\r\n  date?: string\r\n}) => {\r\n  return (\r\n    <small className=\"author text-muted\">\r\n      <div className=\"flex flex-column\">\r\n        <Link to={`/users/${user.id}`} store={pathStore}>\r\n          {user.name}\r\n        </Link>\r\n        {date ? <span className=\"created-at\">{formatUTCDate(date.toString())}</span> : <></>}\r\n      </div>\r\n\r\n      <div className=\"avatar-wrapper sm\">\r\n        <img src={user.avatarUrl} className=\"avatar\" alt={user.name} />\r\n      </div>\r\n    </small>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { getLatestPostsCommunities } from \"../client/actions/communities\"\r\nimport { pathStore } from \"../state/global\"\r\nimport { selectedCommunity } from \"../state/community\"\r\nimport { LatestPostsData } from \"../types/post\"\r\nimport { DefaultLoader } from \"../components/loaders/Default\"\r\nimport { AuthorTag } from \"../components/AuthorTag\"\r\nimport { Link } from \"cinnabun/router\"\r\n\r\nconst PostCard = ({ post, community, user }: LatestPostsData) => {\r\n  return (\r\n    <div className=\"card\" key={post.id}>\r\n      <div className=\"card-title flex justify-content-between\">\r\n        {post.title}\r\n        <Link\r\n          onBeforeNavigate={() => {\r\n            selectedCommunity.value = { ...community }\r\n            return true\r\n          }}\r\n          store={pathStore}\r\n          to={`/communities/${community.url_title}`}\r\n          className=\"text-primary\"\r\n        >\r\n          {community.title}\r\n        </Link>\r\n      </div>\r\n      <div className=\"card-body\">{post.content}</div>\r\n      <div className=\"flex justify-content-between\">\r\n        <div></div>\r\n        <div className=\"flex flex-column align-items-end\">\r\n          <AuthorTag user={user} date={post.createdAt.toString()} />\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default function Home() {\r\n  return (\r\n    <div className=\"flex gap flex-wrap\">\r\n      <section>\r\n        <div className=\"section-header\">\r\n          <h2>Latest posts</h2>\r\n        </div>\r\n        <Cinnabun.Suspense promise={getLatestPostsCommunities} cache>\r\n          {(loading: boolean, data?: LatestPostsData[]) => {\r\n            if (loading) return <DefaultLoader />\r\n            if (!data) return <div className=\"text-muted\">No posts yet.</div>\r\n            return <Cinnabun.For each={data} template={(item) => <PostCard {...item} />} />\r\n          }}\r\n        </Cinnabun.Suspense>\r\n      </section>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { truncateText } from \"../../utils\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { pathStore } from \"../../state/global\"\r\nimport \"./CommunityListCard.css\"\r\nimport type { CommunityListData } from \"../../types/community\"\r\nimport { selectedCommunity } from \"../../state/community\"\r\n\r\nexport const CommunityListCard = (props: CommunityListData) => {\r\n  const { members, community } = props\r\n\r\n  const nMembers = parseInt(members.toString())\r\n\r\n  return (\r\n    <div className=\"card community-card\" key={community.id}>\r\n      <div className=\"card-title flex justify-content-between\">\r\n        <div className=\"flex gap align-items-center\">\r\n          <h2 className=\"m-0\">\r\n            <a\r\n              href={`/communities/${community.url_title}`}\r\n              onclick={(e: Event) => {\r\n                e.preventDefault()\r\n                selectedCommunity.value = {\r\n                  id: community.id,\r\n                  title: community.title,\r\n                  url_title: community.url_title!,\r\n                  description: community.description,\r\n                  private: !!community.private,\r\n                  disabled: !!community.disabled,\r\n                }\r\n                setPath(pathStore, `/communities/${community.url_title}`)\r\n              }}\r\n            >\r\n              {community.title}\r\n            </a>\r\n            {community.private ? <span className=\"badge text-light ml-2\">Private</span> : <></>}\r\n          </h2>\r\n        </div>\r\n        <small className=\"text-muted nowrap\">\r\n          {nMembers} {nMembers > 1 ? \"members\" : \"member\"}\r\n        </small>\r\n      </div>\r\n      <p className=\"card-description text-muted\">{truncateText(community.description, 128)}</p>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { For } from \"cinnabun\"\r\nimport { CommunityListCard } from \"./CommunityListCard\"\r\nimport type { CommunityListData } from \"../../types/community\"\r\n\r\nexport const CommunityList = ({ communities }: { communities: CommunityListData[] }) => {\r\n  return (\r\n    <ul className=\"card-list w-100\">\r\n      <For each={communities} template={(community) => <CommunityListCard {...community} />} />\r\n    </ul>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentChildren, ComponentProps } from \"cinnabun/types\"\r\n\r\nexport const Button = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <button {...props}>\r\n      <span className=\"flex align-items-center gap-sm\">{children}</span>\r\n    </button>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { getCommunities } from \"../client/actions/communities\"\r\nimport { CommunityList } from \"../components/communities/CommunityList\"\r\nimport { DefaultLoader } from \"../components/loaders/Default\"\r\nimport { Button } from \"../components/Button\"\r\nimport { userStore, authModalOpen, authModalState } from \"../state/global\"\r\nimport { communityCreatorModalOpen } from \"../state/community\"\r\nimport { AuthModalCallback } from \"../types/auth\"\r\nimport { CommunityListData } from \"../types/community\"\r\n\r\nexport default function Communities() {\r\n  const handleCreateCommunityClick = () => {\r\n    if (!userStore.value) {\r\n      authModalState.value = {\r\n        title: \"Log in to create a Community\",\r\n        message: \"You must be logged in to create a Community.\",\r\n        callbackAction: AuthModalCallback.CreateCommunity,\r\n      }\r\n      authModalOpen.value = true\r\n      return\r\n    }\r\n    communityCreatorModalOpen.value = true\r\n  }\r\n  return (\r\n    <>\r\n      <div className=\"page-title flex align-items-center justify-content-between gap flex-wrap\">\r\n        <h1>Communities</h1>\r\n        <Button\r\n          className=\"btn btn-primary hover-animate sm_btn-sm md_btn-md lg_btn-lg\"\r\n          onclick={handleCreateCommunityClick}\r\n        >\r\n          Create a Community\r\n        </Button>\r\n      </div>\r\n      <div className=\"page-body\">\r\n        <Cinnabun.Suspense promise={getCommunities} cache>\r\n          {(loading: boolean, res: CommunityListData[] | undefined) => {\r\n            if (loading) return <DefaultLoader />\r\n            if (!res)\r\n              return (\r\n                <div>\r\n                  <span className=\"text-danger\">Oops! Something went wrong \uD83D\uDE22</span>\r\n                </div>\r\n              )\r\n            if (res.length === 0)\r\n              return (\r\n                <div>\r\n                  <span className=\"text-muted\">\r\n                    There are no communities to show... Why not create one?\r\n                  </span>\r\n                </div>\r\n              )\r\n\r\n            return <CommunityList communities={res} />\r\n          }}\r\n        </Cinnabun.Suspense>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { PropsWithChildren } from \"cinnabun/types\"\r\nimport \"./IconButton.css\"\r\n\r\nexport const IconButton = ({ children, ...rest }: PropsWithChildren) => {\r\n  const { className, ...others } = rest\r\n  const _className = \"icon-button \" + (rest.className ?? \"\")\r\n  return (\r\n    <button className={_className} {...others}>\r\n      {children}\r\n    </button>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\nimport { IconColorProps } from \".\"\r\n\r\nexport const ThumbsUpIcon = (props: ComponentProps & IconColorProps) => {\r\n  const { color = \"#000000\", ...rest } = props\r\n  const hoverColor = props[\"color:hover\"] ?? color\r\n\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1em\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke={color}\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      style={`--hover-stroke: ${hoverColor}`}\r\n      className=\"stroke\"\r\n      {...rest}\r\n    >\r\n      <path d=\"M7 10v12\" />\r\n      <path d=\"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\nimport { IconColorProps } from \".\"\r\n\r\nexport const ThumbsDownIcon = (props: ComponentProps & IconColorProps) => {\r\n  const { color = \"#000000\", ...rest } = props\r\n  const hoverColor = props[\"color:hover\"] ?? color\r\n\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1em\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke={color}\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      className=\"stroke\"\r\n      style={`--hover-stroke: ${hoverColor}`}\r\n      {...rest}\r\n    >\r\n      <path d=\"M17 14V2\" />\r\n      <path d=\"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import { addNotification } from \"../../components/Notifications\"\r\nimport { API_URL } from \"../../constants\"\r\nimport { NewPost } from \"../../db/schema\"\r\n\r\nexport const getPost = async (postId: string) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/posts/${postId}`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const addPostComment = async (postId: string, comment: string) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/posts/${postId}/comments`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ comment }),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const addPostReaction = async (postId: string, reaction: boolean) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/posts/${postId}/reactions`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify({ reaction }),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const addPost = async (post: NewPost) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/posts`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(post),\r\n    })\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    console.error(error)\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n\r\nexport const getPosts = async (communityId: string, offset: number) => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/posts?communityId=${communityId}&offset=${offset}`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\nimport \"./Ellipsis.css\"\r\n\r\nexport const EllipsisLoader = (props: ComponentProps) => {\r\n  const { className, ...rest } = props\r\n  return (\r\n    <div className={`lds-ellipsis ${className}`} {...rest}>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n      <div></div>\r\n    </div>\r\n  )\r\n}\r\n", "export const pollValidation = {\r\n  minPollDescLength: 1,\r\n  maxPollDescLength: 255,\r\n  minPollOptions: 2,\r\n  minPollOptionDescLength: 1,\r\n  maxPollOptionDescLength: 32,\r\n  isPollValid: (desc: string, options: string[]): boolean => {\r\n    if (\r\n      desc.length < pollValidation.minPollDescLength ||\r\n      desc.length > pollValidation.maxPollDescLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    if (options.length < pollValidation.minPollOptions) {\r\n      return false\r\n    }\r\n    if (\r\n      options.some(\r\n        (option) =>\r\n          option.length < pollValidation.minPollOptionDescLength ||\r\n          option.length > pollValidation.maxPollOptionDescLength\r\n      )\r\n    ) {\r\n      return false\r\n    }\r\n    return true\r\n  },\r\n}\r\n\r\nexport const communityValidation = {\r\n  minCommunityNameLength: 6,\r\n  maxCommunityNameLength: 128,\r\n  minCommunityDescLength: 0,\r\n  maxCommunityDescLength: 255,\r\n  isCommunityNameValid: (name: string | undefined) => {\r\n    if (!name) return false\r\n    if (\r\n      name.length < communityValidation.minCommunityNameLength ||\r\n      name.length > communityValidation.maxCommunityNameLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    if (!/^[a-zA-Z0-9-_ ()]*$/.test(name)) {\r\n      return false\r\n    }\r\n    return true\r\n  },\r\n  isCommunityValid: (name: string | undefined, desc: string | undefined) => {\r\n    if (!desc) return false\r\n    if (!communityValidation.isCommunityNameValid(name)) return false\r\n    if (\r\n      desc.length < communityValidation.minCommunityDescLength ||\r\n      desc.length > communityValidation.maxCommunityDescLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  },\r\n}\r\n\r\nexport const postValidation = {\r\n  minPostTitleLength: 1,\r\n  maxPostTitleLength: 128,\r\n  minPostContentLength: 1,\r\n  maxPostContentLength: 2048,\r\n  isPostValid: (title: string, content: string) => {\r\n    if (\r\n      title.length < postValidation.minPostTitleLength ||\r\n      title.length > postValidation.maxPostTitleLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    if (\r\n      content.length < postValidation.minPostContentLength ||\r\n      content.length > postValidation.maxPostContentLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  },\r\n}\r\n\r\nexport const commentValidation = {\r\n  minCommentContentLength: 1,\r\n  maxCommentContentLength: 255,\r\n  isCommentValid: (content: string) => {\r\n    if (\r\n      content.length < commentValidation.minCommentContentLength ||\r\n      content.length > commentValidation.maxCommentContentLength\r\n    ) {\r\n      return false\r\n    }\r\n\r\n    return true\r\n  },\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { For, createSignal, computed } from \"cinnabun\"\r\nimport { CommunityPostComment, CommunityPostData } from \"../../types/post\"\r\nimport { authModalOpen, authModalState, pathStore, userStore } from \"../../state/global\"\r\nimport { isCommunityMember, communityJoinModalOpen } from \"../../state/community\"\r\nimport { addPostComment } from \"../../client/actions/posts\"\r\nimport { formatUTCDate } from \"../../utils\"\r\nimport { Button } from \"../Button\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\nimport { commentValidation } from \"../../db/validation\"\r\nimport { AuthModalCallback } from \"../../types/auth\"\r\nimport { Link } from \"cinnabun/router\"\r\n\r\nconst CommentItem = ({ comment }: { comment: CommunityPostComment }) => {\r\n  return (\r\n    <div className=\"comment-item flex align-items-center gap\" key={comment.id}>\r\n      <div className=\"avatar-wrapper sm\">\r\n        <img className=\"avatar\" src={comment.user.avatarUrl} alt={comment.user.name} />\r\n      </div>\r\n      <div className=\"flex flex-column gap-sm flex-grow text-sm\">\r\n        <div className=\"text-muted flex align-items-center gap justify-content-between\">\r\n          <Link to={`/users/${comment.user.id}`} store={pathStore} className=\"author\">\r\n            {comment.user.name}\r\n          </Link>\r\n          <span>{formatUTCDate(comment.createdAt.toString())}</span>\r\n        </div>\r\n        <p className=\"m-0 comment\">{comment.content}</p>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nconst CommentsList = ({ comments }: { comments: Cinnabun.Signal<CommunityPostComment[]> }) => {\r\n  return (\r\n    <div className=\"comments-list\">\r\n      <p\r\n        className=\"text-muted m-0\"\r\n        watch={comments}\r\n        bind:visible={() => comments.value.length === 0}\r\n      >\r\n        <small>\r\n          <i>No comments yet.</i>\r\n        </small>\r\n      </p>\r\n      <For each={comments} template={(comment) => <CommentItem comment={comment} />} />\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const PostCardComments = ({ post }: { post: Cinnabun.Signal<CommunityPostData> }) => {\r\n  const comments = computed(post, () => post.value.comments)\r\n  return (\r\n    <div className=\"post-card-comments flex flex-column gap\">\r\n      <CommentsList comments={comments} />\r\n      <NewCommentForm post={post} />\r\n    </div>\r\n  )\r\n}\r\n\r\nconst NewCommentForm = ({ post }: { post: Cinnabun.Signal<CommunityPostData> }) => {\r\n  const newComment = createSignal(\"\")\r\n  const loading = createSignal(false)\r\n\r\n  const handleSubmit = async (e: Event) => {\r\n    e.preventDefault()\r\n    if (!userStore.value) {\r\n      if (!userStore.value) {\r\n        authModalState.value = {\r\n          title: \"Log in to interact with this post\",\r\n          message: \"You must be logged in to interact with community posts.\",\r\n          callbackAction: AuthModalCallback.ViewCommunity,\r\n        }\r\n        authModalOpen.value = true\r\n        return\r\n      }\r\n      return\r\n    }\r\n    if (!isCommunityMember()) {\r\n      communityJoinModalOpen.value = true\r\n      return\r\n    }\r\n    e.preventDefault()\r\n    loading.value = true\r\n    const res = await addPostComment(post.value.id, newComment.value)\r\n    if (res) {\r\n      post.value.comments.push(res)\r\n      post.notify()\r\n      newComment.value = \"\"\r\n    }\r\n    loading.value = false\r\n  }\r\n\r\n  const handleInput = (e: Event) => {\r\n    e.preventDefault()\r\n    newComment.value = (e.target as HTMLInputElement).value\r\n  }\r\n\r\n  return (\r\n    <form\r\n      className=\"flex align-items-center gap flex-wrap justify-content-end\"\r\n      onsubmit={handleSubmit}\r\n    >\r\n      <div className=\"flex align-items-center gap flex-wrap flex-grow\">\r\n        <div className=\"avatar-wrapper sm\">\r\n          <img className=\"avatar\" src={userStore.value?.picture} alt={userStore.value?.name} />\r\n        </div>\r\n        <div className=\"flex-grow\">\r\n          <textarea\r\n            className=\"form-control\"\r\n            placeholder=\"Write a comment...\"\r\n            watch={newComment}\r\n            bind:value={() => newComment.value}\r\n            oninput={handleInput}\r\n          />\r\n        </div>\r\n      </div>\r\n      <Button\r\n        watch={[loading, newComment]}\r\n        bind:disabled={() => loading.value || !commentValidation.isCommentValid(newComment.value)}\r\n        type=\"submit\"\r\n        className=\"btn btn-primary hover-animate\"\r\n      >\r\n        Add Comment\r\n        <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n      </Button>\r\n    </form>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal, computed } from \"cinnabun\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { truncateText } from \"../../utils\"\r\nimport { CommunityPostData } from \"../../types/post\"\r\nimport { IconButton } from \"../IconButton\"\r\nimport { ThumbsUpIcon } from \"../icons/ThumbsUpIcon\"\r\nimport { ThumbsDownIcon } from \"../icons/ThumbsDownIcon\"\r\nimport { addPostReaction } from \"../../client/actions/posts\"\r\nimport { isCommunityMember, communityJoinModalOpen, selectedCommunity } from \"../../state/community\"\r\nimport { userStore, authModalState, authModalOpen, pathStore } from \"../../state/global\"\r\n\r\nimport { PostCardComments } from \"./PostCardComments\"\r\nimport { AuthorTag } from \"../AuthorTag\"\r\nimport \"./PostCard.css\"\r\nimport { AuthModalCallback } from \"../../types/auth\"\r\n\r\nexport const PostCard = ({ post }: { post: CommunityPostData }) => {\r\n  const state = createSignal(post)\r\n  const reacting = createSignal(false)\r\n  const userReaction = computed(state, () => {\r\n    if (!userStore.value) return undefined\r\n    return state.value.reactions.find((r) => r.ownerId === userStore.value?.userId)\r\n  })\r\n\r\n  const addReaction = async (reaction: boolean) => {\r\n    if (reacting.value) return\r\n    if (!userStore.value) {\r\n      authModalState.value = {\r\n        title: \"Log in to interact with this post\",\r\n        message: \"You must be logged in to interact with community posts.\",\r\n        callbackAction: AuthModalCallback.ViewCommunity,\r\n      }\r\n      authModalOpen.value = true\r\n      return\r\n    }\r\n    if (userReaction.value?.reaction === reaction) return\r\n    if (!isCommunityMember()) {\r\n      communityJoinModalOpen.value = true\r\n      return\r\n    }\r\n\r\n    reacting.value = true\r\n    const res = await addPostReaction(post.id, reaction)\r\n    if (res) {\r\n      // find and remove previous reaction\r\n      const prevReaction = state.value.reactions.find((r) => r.ownerId === userStore?.value?.userId)\r\n      if (prevReaction) {\r\n        state.value.reactions.splice(state.value.reactions.indexOf(prevReaction), 1)\r\n      }\r\n\r\n      state.value.reactions.push(res)\r\n      state.notify()\r\n    }\r\n    reacting.value = false\r\n  }\r\n\r\n  const totalReactions = computed(state, () => {\r\n    return state.value.reactions.reduce(\r\n      (acc, reaction) => {\r\n        if (reaction.reaction) {\r\n          acc.positive++\r\n        } else {\r\n          acc.negative++\r\n        }\r\n        return acc\r\n      },\r\n      { positive: 0, negative: 0 }\r\n    )\r\n  })\r\n\r\n  return (\r\n    <div className=\"card post-card flex flex-column\" key={post.id}>\r\n      <div className=\"flex justify-content-between gap\">\r\n        <h4 className=\"m-0 title\">\r\n          <a\r\n            href={`/communities/${selectedCommunity.value?.url_title}/${post.id}`}\r\n            onclick={(e: Event) => {\r\n              e.preventDefault()\r\n              setPath(pathStore, `/communities/${selectedCommunity.value?.url_title}/${post.id}`)\r\n            }}\r\n          >\r\n            {post.title}\r\n          </a>\r\n        </h4>\r\n        <AuthorTag user={post.user} date={post.createdAt.toString()} />\r\n      </div>\r\n      <p className=\"post-card-content\">{truncateText(post.content, 256)}</p>\r\n      <div className=\"flex gap post-reactions\">\r\n        <IconButton\r\n          onclick={() => addReaction(true)}\r\n          bind:className={() =>\r\n            `icon-button flex align-items-center gap-sm ${\r\n              userReaction.value?.reaction === true ? \"selected\" : \"\"\r\n            }`\r\n          }\r\n          watch={[userStore, reacting, userReaction]}\r\n          bind:disabled={() => reacting.value}\r\n        >\r\n          <ThumbsUpIcon\r\n            color=\"var(--primary)\"\r\n            color:hover=\"var(--primary-light)\"\r\n            className=\"text-rg\"\r\n          />\r\n          <small className=\"text-muted\" watch={totalReactions} bind:children>\r\n            {() => totalReactions.value.positive}\r\n          </small>\r\n        </IconButton>\r\n        <IconButton\r\n          onclick={() => addReaction(false)}\r\n          bind:className={() =>\r\n            `icon-button flex align-items-center gap-sm ${\r\n              userReaction.value?.reaction === false ? \"selected\" : \"\"\r\n            }`\r\n          }\r\n          watch={[userStore, reacting, userReaction]}\r\n          bind:disabled={() => reacting.value}\r\n        >\r\n          <ThumbsDownIcon\r\n            color=\"var(--primary)\"\r\n            color:hover=\"var(--primary-light)\"\r\n            className=\"text-rg\"\r\n          />\r\n          <small className=\"text-muted\" watch={totalReactions} bind:children>\r\n            {() => totalReactions.value.negative}\r\n          </small>\r\n        </IconButton>\r\n      </div>\r\n      <PostCardComments post={state} />\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { For } from \"cinnabun\"\r\nimport { PostCard } from \"./PostCard\"\r\nimport { CommunityPostData } from \"../../types/post\"\r\n\r\nexport const CommunityPosts = ({ posts }: { posts: CommunityPostData[] }) => {\r\n  return (\r\n    <div className=\"flex flex-column\">\r\n      {posts.length ? (\r\n        <div className=\"flex flex-column\">\r\n          <For each={posts} template={(post) => <PostCard post={post} />} />\r\n        </div>\r\n      ) : (\r\n        <div>\r\n          <i className=\"text-muted\">No posts yet \uD83D\uDE22</i>\r\n        </div>\r\n      )}\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { CommunityMemberData } from \"../../types/community\"\r\n\r\nexport const CommunityMemberCard = ({ member }: { member: CommunityMemberData }) => {\r\n  return (\r\n    <div className=\"card flex flex-column\" key={member.id}>\r\n      <div className=\"flex justify-content-between gap align-items-start\">\r\n        <div className=\"avatar-wrapper sm\">\r\n          <img crossOrigim className=\"avatar\" src={member.user.avatarUrl} alt={member.user.name} />\r\n        </div>\r\n        <h4 className=\"m-0 w-100 nowrap\">{member.user.name}</h4>\r\n        <small className=\"member-since text-muted\">\r\n          Since {new Date(member.createdAt).toLocaleString().split(\",\")[0]}\r\n        </small>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentProps } from \"cinnabun/types\"\r\nimport { IconColorProps } from \".\"\r\n\r\nexport const EditIcon = (props: ComponentProps & IconColorProps) => {\r\n  const { color = \"#000000\", ...rest } = props\r\n  const hoverColor = props[\"color:hover\"] ?? color\r\n\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      stroke={color}\r\n      style={`--hover-stroke: ${hoverColor}`}\r\n      className=\"stroke\"\r\n      {...rest}\r\n    >\r\n      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\r\n      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const MenuIcon = () => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n    >\r\n      <line x1=\"4\" x2=\"20\" y1=\"12\" y2=\"12\" />\r\n      <line x1=\"4\" x2=\"20\" y1=\"6\" y2=\"6\" />\r\n      <line x1=\"4\" x2=\"20\" y1=\"18\" y2=\"18\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const MoreIcon = () => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n      class=\"lucide lucide-more-horizontal\"\r\n    >\r\n      <circle cx=\"12\" cy=\"12\" r=\"1\" />\r\n      <circle cx=\"19\" cy=\"12\" r=\"1\" />\r\n      <circle cx=\"5\" cy=\"12\" r=\"1\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { authModalOpen, authModalState, userStore } from \"../../state/global\"\r\nimport {\r\n  communityJoinModalOpen,\r\n  isCommunityMember,\r\n  postCreatorModalOpen,\r\n} from \"../../state/community\"\r\nimport { Button } from \"../Button\"\r\nimport { AuthModalCallback } from \"../../types/auth\"\r\n\r\nexport const AddPostButton = () => {\r\n  const handleAddNewPost = () => {\r\n    if (!userStore.value) {\r\n      authModalState.value = {\r\n        title: \"Log in to create a Post\",\r\n        message: \"You must be logged in to create a Post.\",\r\n        callbackAction: AuthModalCallback.CreatePost,\r\n      }\r\n      authModalOpen.value = true\r\n      return\r\n    }\r\n    if (!isCommunityMember()) {\r\n      communityJoinModalOpen.value = true\r\n      return\r\n    }\r\n    postCreatorModalOpen.value = true\r\n  }\r\n\r\n  return (\r\n    <Button className=\"btn btn-primary hover-animate\" onclick={handleAddNewPost} watch={userStore}>\r\n      Create post\r\n    </Button>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { SlideInOut } from \"cinnabun-transitions\"\r\nimport {\r\n  selectedCommunity,\r\n  isCommunityOwner,\r\n  communityEditorModalOpen,\r\n} from \"../../state/community\"\r\nimport { IconButton } from \"../IconButton\"\r\nimport { EditIcon } from \"../icons\"\r\nimport { AddPostButton } from \"./AddPostButton\"\r\nexport const CommunityFixedHeader = () => {\r\n  const hasScrolled = createSignal(false)\r\n\r\n  const onScroll = () => {\r\n    if (hasScrolled.value && window.scrollY > 100) return\r\n    hasScrolled.value = window.scrollY > 100\r\n  }\r\n\r\n  const onMounted = () => {\r\n    window.addEventListener(\"scroll\", onScroll)\r\n  }\r\n  const onUnmounted = () => {\r\n    window.removeEventListener(\"scroll\", onScroll)\r\n  }\r\n\r\n  return (\r\n    <div onMounted={onMounted} onUnmounted={onUnmounted}>\r\n      <SlideInOut\r\n        className=\"community-page-fixed-title flex justify-content-between align-items-center\"\r\n        settings={{ from: \"top\" }}\r\n        watch={hasScrolled}\r\n        bind:visible={() => hasScrolled.value}\r\n        cancelExit={() => hasScrolled.value}\r\n      >\r\n        <div className=\"flex gap align-items-center\">\r\n          <h2 className=\"m-0 text-light\">{() => selectedCommunity.value?.title}</h2>\r\n          {isCommunityOwner() ? (\r\n            <IconButton onclick={() => (communityEditorModalOpen.value = true)}>\r\n              <EditIcon color=\"var(--light)\" />\r\n            </IconButton>\r\n          ) : (\r\n            <></>\r\n          )}\r\n        </div>\r\n        <AddPostButton />\r\n      </SlideInOut>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { For, createSignal } from \"cinnabun\"\r\nimport { communityDrawerOpen, pendingCommunityJoinRequests } from \"../../state/community\"\r\nimport { CommunityJoinRequestData } from \"../../types/community\"\r\nimport { respondToCommunityJoinRequest } from \"../../client/actions/communities\"\r\nimport { addNotification } from \"../Notifications\"\r\n\r\nconst JoinRequestCard = (joinReq: CommunityJoinRequestData) => {\r\n  const { id, communityId } = joinReq\r\n\r\n  const loading = createSignal(false)\r\n\r\n  const respondToRequest = async (communityId: string, joinRequestId: string, accept: boolean) => {\r\n    loading.value = true\r\n    const res = await respondToCommunityJoinRequest(communityId, joinRequestId, accept)\r\n    if (!res) {\r\n      loading.value = false\r\n      return\r\n    }\r\n    const idx = pendingCommunityJoinRequests.value.findIndex((j) => j.id === joinRequestId)\r\n    pendingCommunityJoinRequests.value.splice(idx, 1)\r\n    pendingCommunityJoinRequests.notify()\r\n    loading.value = false\r\n    addNotification({\r\n      text: `You ${accept ? \"accepted\" : \"rejected\"} ${joinReq.user.name}'s join request`,\r\n      type: \"success\",\r\n    })\r\n    // if (selectedCommunity.value?.members) {\r\n    //   selectedCommunity.value.members.push({\r\n    //     id: res.id,\r\n    //     name: res.name,\r\n    //     avatarUrl: res.avatarUrl,\r\n    //   })\r\n    //   selectedCommunity.notify()\r\n    // }\r\n    if (pendingCommunityJoinRequests.value.length === 0) {\r\n      communityDrawerOpen.value = false\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div key={id} className=\"card flex-row align-items-center\">\r\n      <div className=\"avatar-wrapper sm rounded-full border-none p-0 bg-primary-darkest\">\r\n        <img className=\"avatar\" src={joinReq.user.avatarUrl} alt=\"avatar\" />\r\n      </div>\r\n      <small>{joinReq.user.name}</small>\r\n      <div className=\"flex flex-wrap gap align-items-center justify-content-end\">\r\n        <button\r\n          type=\"button\"\r\n          className=\"btn btn-primary\"\r\n          watch={loading}\r\n          bind:disabled={() => loading.value}\r\n          onclick={() => respondToRequest(communityId, id, true)}\r\n        >\r\n          Accept\r\n        </button>\r\n        <button\r\n          type=\"button\"\r\n          className=\"btn btn-danger\"\r\n          watch={loading}\r\n          bind:disabled={() => loading.value}\r\n          onclick={() => respondToRequest(communityId, id, false)}\r\n        >\r\n          Reject\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const PendingJoinRequests = () => {\r\n  return (\r\n    <div>\r\n      <For each={pendingCommunityJoinRequests} template={JoinRequestCard} />\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { IconButton } from \"../../IconButton\"\r\nimport { MoreIcon } from \"../../icons\"\r\nimport { SlideInOut } from \"cinnabun-transitions\"\r\nimport \"./AdminMenu.css\"\r\nimport {\r\n  communityDrawerOpen,\r\n  communityDrawerState,\r\n  pendingCommunityJoinRequests,\r\n  selectedCommunity,\r\n} from \"../../../state/community\"\r\nimport { getCommunityJoinRequests } from \"../../../client/actions/communities\"\r\nimport { PendingJoinRequests } from \"../PendingJoinRequests\"\r\nimport { EllipsisLoader } from \"../../loaders/Ellipsis\"\r\n\r\nconst loadRequests = async () => {\r\n  const res = !!selectedCommunity.value?.id\r\n    ? await getCommunityJoinRequests(selectedCommunity.value.id)\r\n    : []\r\n  pendingCommunityJoinRequests.value = res ?? []\r\n}\r\n\r\nconst handlePendingRequestsClick = () => {\r\n  communityDrawerState.value = {\r\n    title: \"Join Requests\",\r\n    componentFunc: PendingJoinRequests,\r\n  }\r\n  communityDrawerOpen.value = true\r\n}\r\n\r\nexport const AdminMenu = () => {\r\n  const showMenu = Cinnabun.createSignal(false)\r\n  const loadingRequests = Cinnabun.createSignal(false)\r\n  const totalNotifications = () => pendingCommunityJoinRequests.value.length\r\n\r\n  return (\r\n    <div className=\"ml-auto\" onMounted={loadRequests}>\r\n      <IconButton\r\n        watch={[showMenu, pendingCommunityJoinRequests, loadingRequests]}\r\n        bind:className={() => `icon-button admin-menu-button ${showMenu.value ? \"selected\" : \"\"}`}\r\n        onclick={() => (showMenu.value = !showMenu.value)}\r\n        bind:children\r\n      >\r\n        <MoreIcon />\r\n        {() =>\r\n          loadingRequests.value ? (\r\n            <EllipsisLoader style=\"color:var(--text-color); font-size: .75rem;\" />\r\n          ) : totalNotifications() > 0 ? (\r\n            <span className=\"badge \">{totalNotifications()}</span>\r\n          ) : (\r\n            <></>\r\n          )\r\n        }\r\n      </IconButton>\r\n      <div style=\"position:relative\">\r\n        <div className=\"admin-menu-wrapper\">\r\n          <SlideInOut\r\n            className=\"admin-menu\"\r\n            watch={showMenu}\r\n            settings={{ from: \"top\" }}\r\n            properties={[{ name: \"opacity\", from: 0, to: 1 }]}\r\n            bind:visible={() => showMenu.value}\r\n          >\r\n            <ul>\r\n              <li>\r\n                <a href=\"javascript:void(0)\">\r\n                  <small>Manage members</small>\r\n                </a>\r\n              </li>\r\n              {selectedCommunity.value?.private ? (\r\n                <li>\r\n                  <a\r\n                    href=\"javascript:void(0)\"\r\n                    onclick={handlePendingRequestsClick}\r\n                    watch={[pendingCommunityJoinRequests, loadingRequests]}\r\n                    bind:children\r\n                  >\r\n                    <small>Join Requests</small>\r\n                    {() =>\r\n                      loadingRequests.value ? (\r\n                        <EllipsisLoader style=\"color:var(--text-color); font-size: .75rem;\" />\r\n                      ) : (\r\n                        <span className=\"badge \">\r\n                          {() => pendingCommunityJoinRequests.value.length}\r\n                        </span>\r\n                      )\r\n                    }\r\n                  </a>\r\n                </li>\r\n              ) : (\r\n                <></>\r\n              )}\r\n            </ul>\r\n          </SlideInOut>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport \"./Page.css\"\r\nimport { getCommunity } from \"../../client/actions/communities\"\r\nimport { DefaultLoader } from \"../../components/loaders/Default\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { authModalOpen, authModalState, pathStore, userStore } from \"../../state/global\"\r\nimport {\r\n  communityDeleteModalOpen,\r\n  communityEditorModalOpen,\r\n  communityJoinModalOpen,\r\n  communityLeaveModalOpen,\r\n  isCommunityAdmin,\r\n  isCommunityMember,\r\n  isCommunityOwner,\r\n  selectedCommunity,\r\n} from \"../../state/community\"\r\nimport { CommunityPosts } from \"../../components/community/CommunityPosts\"\r\nimport { CommunityData } from \"../../types/community\"\r\nimport { CommunityMemberCard } from \"../../components/community/CommunityMemberCard\"\r\nimport { IconButton } from \"../../components/IconButton\"\r\nimport { EditIcon } from \"../../components/icons\"\r\n\r\nimport { CommunityFixedHeader } from \"../../components/community/CommunityFixedHeader\"\r\nimport { AddPostButton } from \"../../components/community/AddPostButton\"\r\nimport { addNotification } from \"../../components/Notifications\"\r\nimport { AuthModalCallback } from \"../../types/auth\"\r\nimport { Button } from \"../../components/Button\"\r\nimport { AdminMenu } from \"../../components/community/AdminMenu/AdminMenu\"\r\n\r\nexport default function CommunityPage({ params }: { params?: { url_title?: string } }) {\r\n  if (!params?.url_title) return setPath(pathStore, \"/communities\")\r\n\r\n  const showLoginPrompt = () => {\r\n    authModalState.value = {\r\n      title: \"Log in to view this community\",\r\n      message:\r\n        \"This community is private and you must be a member of the community to view its content.\",\r\n      callbackAction: AuthModalCallback.ViewCommunity,\r\n    }\r\n    authModalOpen.value = true\r\n  }\r\n\r\n  const loadCommunity = async (): Promise<Partial<CommunityData> | { message: string }> => {\r\n    const res = await getCommunity(params.url_title!)\r\n    if (\"message\" in res) {\r\n      addNotification({\r\n        type: \"error\",\r\n        text: res.message,\r\n      })\r\n      setPath(pathStore, \"/communities\")\r\n      return res\r\n    }\r\n\r\n    if (!canViewCommunityData(res)) {\r\n      if (userStore.value) {\r\n        communityJoinModalOpen.value = true\r\n      } else {\r\n        showLoginPrompt()\r\n      }\r\n    }\r\n\r\n    selectedCommunity.value = {\r\n      id: res.id,\r\n      title: res.title,\r\n      url_title: params.url_title!,\r\n      description: res.description,\r\n      disabled: res.disabled,\r\n      private: res.private,\r\n      createdAt: res.createdAt,\r\n      memberType: res.memberType,\r\n      members: res.members,\r\n      owners: res.owners,\r\n      posts: res.posts,\r\n      moderators: res.moderators,\r\n    }\r\n    return res\r\n  }\r\n\r\n  const canViewCommunityData = (data: Partial<CommunityData>) => {\r\n    return !data.private || (data.memberType && data.memberType !== \"guest\")\r\n  }\r\n\r\n  return (\r\n    <div>\r\n      <Cinnabun.Suspense promise={loadCommunity} cache>\r\n        {(loading: boolean, data: Partial<CommunityData> | { message: string }) => {\r\n          if (data && \"message\" in data) return data.message\r\n\r\n          return (\r\n            <div className=\"page-wrapper\">\r\n              <div className=\"page-title\">\r\n                <div className=\"flex gap align-items-center\">\r\n                  <h1 watch={selectedCommunity} bind:children>\r\n                    {() => selectedCommunity.value?.title}\r\n                  </h1>\r\n                  {isCommunityOwner() ? (\r\n                    <IconButton onclick={() => (communityEditorModalOpen.value = true)}>\r\n                      <EditIcon color=\"var(--primary)\" />\r\n                    </IconButton>\r\n                  ) : (\r\n                    <></>\r\n                  )}\r\n                  {isCommunityAdmin() ? <AdminMenu /> : <></>}\r\n                </div>\r\n                <p watch={selectedCommunity} bind:children className=\"page-description\">\r\n                  {() => selectedCommunity.value?.description ?? \"\"}\r\n                </p>\r\n              </div>\r\n\r\n              {loading ? (\r\n                <div className=\"page-body\">\r\n                  <DefaultLoader />\r\n                </div>\r\n              ) : canViewCommunityData(data) ? (\r\n                <>\r\n                  <CommunityFixedHeader />\r\n\r\n                  {isCommunityOwner() ? (\r\n                    <>\r\n                      <div className=\"flex gap\">\r\n                        <Button\r\n                          className=\"btn btn-danger hover-animate btn-sm\"\r\n                          onclick={() => (communityDeleteModalOpen.value = true)}\r\n                        >\r\n                          Delete this community\r\n                        </Button>\r\n                        <Button\r\n                          className=\"btn btn-primary hover-animate btn-sm\"\r\n                          onclick={() => (communityLeaveModalOpen.value = true)}\r\n                        >\r\n                          Transfer ownership\r\n                        </Button>\r\n                      </div>\r\n                      <br />\r\n                    </>\r\n                  ) : isCommunityMember() ? (\r\n                    <>\r\n                      <div>\r\n                        <Button\r\n                          className=\"btn btn-danger hover-animate btn-sm\"\r\n                          onclick={() => (communityLeaveModalOpen.value = true)}\r\n                        >\r\n                          Leave this community\r\n                        </Button>\r\n                      </div>\r\n                      <br />\r\n                    </>\r\n                  ) : (\r\n                    <> </>\r\n                  )}\r\n\r\n                  <div className=\"page-body\">\r\n                    <div className=\"community-page-inner\">\r\n                      <section className=\"flex flex-column community-page-posts\">\r\n                        <div className=\"section-title\">\r\n                          <h3>Posts</h3>\r\n                          <AddPostButton />\r\n                        </div>\r\n                        <CommunityPosts posts={data.posts ?? []} />\r\n                      </section>\r\n                      <section className=\"flex flex-column community-page-members\">\r\n                        {data.owners && data.owners[0] ? (\r\n                          <>\r\n                            <div className=\"section-title\">\r\n                              <h3>Owner</h3>\r\n                            </div>\r\n                            <div className=\"flex flex-column mb-3\">\r\n                              <CommunityMemberCard member={data.owners[0]} />\r\n                            </div>\r\n                          </>\r\n                        ) : (\r\n                          <></>\r\n                        )}\r\n                        {data.members ? (\r\n                          <>\r\n                            <div className=\"section-title\">\r\n                              <h3>Members</h3>\r\n                            </div>\r\n                            <div className=\"flex flex-column\">\r\n                              {data.members.map((member) => (\r\n                                <CommunityMemberCard member={member} />\r\n                              ))}\r\n                            </div>\r\n                          </>\r\n                        ) : (\r\n                          <></>\r\n                        )}\r\n                      </section>\r\n                    </div>\r\n                  </div>\r\n                </>\r\n              ) : userStore.value ? (\r\n                <Button\r\n                  className=\"btn btn-primary hover-animate btn-lg\"\r\n                  onclick={() => (communityJoinModalOpen.value = true)}\r\n                >\r\n                  Join to view this community\r\n                </Button>\r\n              ) : (\r\n                <Button className=\"btn btn-primary hover-animate btn-lg\" onclick={showLoginPrompt}>\r\n                  Log in to view this community\r\n                </Button>\r\n              )}\r\n            </div>\r\n          )\r\n        }}\r\n      </Cinnabun.Suspense>\r\n    </div>\r\n  )\r\n}\r\n", "import { addNotification } from \"../../components/Notifications\"\r\nimport { API_URL } from \"../../constants\"\r\nimport { MyCommunitiesData } from \"../../types/community\"\r\n\r\nexport const getMyCommunities = async (): Promise<MyCommunitiesData | void> => {\r\n  try {\r\n    const response = await fetch(`${API_URL}/me/communities`)\r\n    const data = await response.json()\r\n    if (!response.ok) throw new Error(data?.message ?? response.statusText)\r\n\r\n    return data\r\n  } catch (error: any) {\r\n    addNotification({\r\n      type: \"error\",\r\n      text: error.message,\r\n    })\r\n  }\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Suspense } from \"cinnabun\"\r\nimport { getMyCommunities } from \"../../client/actions/me\"\r\nimport { CommunityListData, MyCommunitiesData } from \"../../types/community\"\r\nimport { DefaultLoader } from \"../loaders/Default\"\r\nimport { CommunityList } from \"../communities/CommunityList\"\r\n\r\nconst CommunityTypeList = ({\r\n  title,\r\n  communities,\r\n}: {\r\n  title: string\r\n  communities: CommunityListData[]\r\n}) => {\r\n  return (\r\n    <section>\r\n      <h3>{title}</h3>\r\n      <CommunityList communities={communities} />\r\n    </section>\r\n  )\r\n}\r\n\r\nexport const MyCommunities = () => {\r\n  return (\r\n    <>\r\n      <h2>My Communities</h2>\r\n      <Suspense promise={getMyCommunities} cache>\r\n        {(loading: boolean, data?: MyCommunitiesData) => {\r\n          if (loading) return <DefaultLoader />\r\n          if (!data) return <></>\r\n          return (\r\n            <>\r\n              <CommunityTypeList title=\"Joined\" communities={data.member} />\r\n              <CommunityTypeList title=\"Owned\" communities={data.owned} />\r\n              <CommunityTypeList title=\"Moderating\" communities={data.moderated} />\r\n            </>\r\n          )\r\n        }}\r\n      </Suspense>\r\n    </>\r\n  )\r\n}\r\n", "import { API_URL } from \"../../constants\"\r\nimport { User } from \"../../db/schema\"\r\n\r\nexport type UserListResponse = { users: User[] }\r\nexport const getUsers = async (page: number = 0): Promise<UserListResponse | void> => {\r\n  try {\r\n    const res = await fetch(`${API_URL}/users?page=${page}`)\r\n    if (!res.ok) throw new Error(\"Failed to fetch users\")\r\n    return await res.json()\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\n\r\nexport const getUser = async (id: string): Promise<User | void> => {\r\n  try {\r\n    const res = await fetch(`${API_URL}/users/${id}`)\r\n    if (!res.ok) throw new Error(\"Failed to fetch user\")\r\n    return await res.json()\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Cinnabun as cb, Suspense } from \"cinnabun\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { pathStore, userStore } from \"../../state/global\"\r\nimport { MyCommunities } from \"../../components/user/MyCommunities\"\r\nimport { getUser } from \"../../client/actions/users\"\r\nimport { PublicUser } from \"../../types/user\"\r\nimport { DefaultLoader } from \"../../components/loaders/Default\"\r\n\r\nexport default function UserPage({ params }: { params?: { userId?: string } }) {\r\n  if (!params?.userId) return setPath(pathStore, \"/users\")\r\n\r\n  if (!cb.isClient) return <></>\r\n\r\n  const isSelfView = () => {\r\n    return params.userId?.toLowerCase() === \"me\"\r\n  }\r\n\r\n  const handleMount = () => {\r\n    if (!userStore.value && isSelfView()) setPath(pathStore, `/`)\r\n  }\r\n\r\n  const loadUser = () => {\r\n    if (isSelfView() && userStore.value) {\r\n      return Promise.resolve({\r\n        user: userStore.value,\r\n      })\r\n    } else if (isSelfView()) {\r\n      return Promise.resolve({})\r\n    }\r\n    return getUser(params.userId!)\r\n  }\r\n\r\n  return (\r\n    <div onMounted={handleMount}>\r\n      <Suspense promise={loadUser}>\r\n        {(loading: boolean, data?: { user?: PublicUser }) => {\r\n          if (loading) return <DefaultLoader />\r\n          if (!data?.user) return <></>\r\n          return <h1>{data?.user.name}</h1>\r\n        }}\r\n      </Suspense>\r\n      <div\r\n        watch={userStore}\r\n        bind:visible={() => !cb.isClient || params?.userId?.toLowerCase() === \"me\"}\r\n      >\r\n        <MyCommunities />\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n", "import { Component } from \"../\"\r\nimport { ComponentChild, ComponentChildren } from \"../types\"\r\n\r\ntype KeyboardListenerProps = {\r\n  keys: string[]\r\n  onCapture: (keys: string[], e: Event) => void\r\n  requireAll?: boolean\r\n}\r\n\r\nexport const KeyboardListener = (\r\n  props: KeyboardListenerProps,\r\n  children: ComponentChildren\r\n) => {\r\n  const { keys, requireAll, onCapture } = props\r\n  let currentKeys: string[] = []\r\n  let self: Component | undefined\r\n\r\n  const triggerCallback = (e: KeyboardEvent) => {\r\n    if (!self || self.children.length === 0) {\r\n      onCapture(currentKeys, e)\r\n      currentKeys = []\r\n      return\r\n    }\r\n    // check if event originated from a child\r\n    // if so, don't trigger callback\r\n    for (const c of self.children) {\r\n      if (componentIsTarget(c, e)) {\r\n        onCapture(currentKeys, e)\r\n        currentKeys = []\r\n        return\r\n      }\r\n    }\r\n    for (const fc of self.funcComponents) {\r\n      if (componentIsTarget(fc, e)) {\r\n        onCapture(currentKeys, e)\r\n        currentKeys = []\r\n        return\r\n      }\r\n    }\r\n  }\r\n\r\n  function componentIsTarget(c: ComponentChild, e: Event) {\r\n    if (c instanceof Component) {\r\n      if (e.target === c.element) return true\r\n      const childIsTarget = c.children.some((child) =>\r\n        componentIsTarget(child, e)\r\n      )\r\n      if (childIsTarget) return true\r\n      const fChildIsTarget = c.funcComponents.some((child) =>\r\n        componentIsTarget(child, e)\r\n      )\r\n      if (fChildIsTarget) return true\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  const handleKeyDown = (e: KeyboardEvent) => {\r\n    const { key } = e\r\n    if (keys.includes(key)) {\r\n      currentKeys.push(key)\r\n      if (!requireAll) {\r\n        return triggerCallback(e)\r\n      }\r\n      if (currentKeys.length === keys.length) triggerCallback(e)\r\n    }\r\n  }\r\n\r\n  const handleKeyUp = (e: KeyboardEvent) => {\r\n    const { key } = e\r\n    if (keys.includes(key)) {\r\n      currentKeys.splice(currentKeys.indexOf(key), 1)\r\n    }\r\n  }\r\n\r\n  return new Component(\"\", {\r\n    children,\r\n    onMounted(c: Component) {\r\n      self = c\r\n      window.addEventListener(\"keydown\", handleKeyDown)\r\n      window.addEventListener(\"keyup\", handleKeyUp)\r\n    },\r\n    onUnmounted() {\r\n      window.removeEventListener(\"keydown\", handleKeyDown)\r\n      window.removeEventListener(\"keyup\", handleKeyUp)\r\n    },\r\n  })\r\n}\r\n", "import { Cinnabun } from \"../cinnabun\"\r\nimport { Component } from \"../\"\r\n\r\ntype NavigationListenerProps = {\r\n  onCapture: (ev: PopStateEvent) => void\r\n}\r\nexport const NavigationListener = (props: NavigationListenerProps) => {\r\n  return new Component(\"\", {\r\n    onMounted() {\r\n      if (!Cinnabun.isClient) return\r\n      window.addEventListener(\"popstate\", props.onCapture)\r\n    },\r\n    onUnmounted() {\r\n      if (!Cinnabun.isClient) return\r\n      window.removeEventListener(\"popstate\", props.onCapture)\r\n    },\r\n  })\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentChildren, ComponentProps } from \"cinnabun/types\"\r\nimport { KeyboardListener, NavigationListener } from \"cinnabun/listeners\"\r\nimport { FadeInOut, Transition } from \"cinnabun-transitions\"\r\nimport \"./Modal.css\"\r\n\r\ntype ModalGestureProps = {\r\n  closeOnNavigate?: boolean\r\n  closeOnClickOutside?: boolean\r\n  closeOnEscape?: boolean\r\n}\r\nconst defaultGestures: ModalGestureProps = {\r\n  closeOnNavigate: true,\r\n  closeOnClickOutside: true,\r\n  closeOnEscape: true,\r\n}\r\n\r\ntype ModalProps = {\r\n  visible: Cinnabun.Signal<boolean>\r\n  toggle: () => void\r\n  onclose?: () => void\r\n  gestures?: ModalGestureProps\r\n}\r\nexport const Modal = (\r\n  { visible, toggle, onclose, gestures = {} }: ModalProps,\r\n  children: ComponentChildren\r\n) => {\r\n  const _gestures = { ...defaultGestures, ...gestures }\r\n  const { closeOnNavigate, closeOnClickOutside, closeOnEscape } = _gestures\r\n\r\n  return (\r\n    <FadeInOut\r\n      properties={[{ name: \"opacity\", from: 0, to: 1, ms: 350 }]}\r\n      className=\"modal-outer\"\r\n      tabIndex={-1}\r\n      watch={visible}\r\n      bind:visible={() => {\r\n        if (!visible.value && onclose) onclose()\r\n        return visible.value\r\n      }}\r\n      onmouseup={(e: MouseEvent) => {\r\n        if (!visible.value || !closeOnClickOutside) return\r\n        const el = e.target as HTMLDivElement\r\n        if (el.className === \"modal-outer\") toggle()\r\n      }}\r\n    >\r\n      <Transition\r\n        className=\"modal\"\r\n        properties={[{ name: \"translate\", from: \"0 -5rem\", to: \"0 0\", ms: 350 }]}\r\n        watch={visible}\r\n        bind:visible={() => visible.value}\r\n      >\r\n        <NavigationListener onCapture={() => closeOnNavigate && toggle()} />\r\n        <KeyboardListener keys={[\"Escape\"]} onCapture={() => closeOnEscape && toggle()} />\r\n        {children}\r\n      </Transition>\r\n    </FadeInOut>\r\n  )\r\n}\r\n\r\nexport const ModalHeader = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"modal-header\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const ModalBody = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"modal-body\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const ModalFooter = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"modal-footer\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { Button } from \"../Button\"\r\nimport { Modal, ModalBody, ModalHeader } from \"../modal/Modal\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\nimport { createCommunity } from \"../../client/actions/communities\"\r\nimport { pathStore } from \"../../state/global\"\r\nimport { communityValidation } from \"../../db/validation\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { communityCreatorModalOpen } from \"../../state/community\"\r\n\r\nexport const CommunityCreator = () => {\r\n  const loading = createSignal(false)\r\n  const state = createSignal({\r\n    title: \"\",\r\n    description: \"\",\r\n  })\r\n  const resetState = () => {\r\n    state.value = {\r\n      title: \"\",\r\n      description: \"\",\r\n    }\r\n  }\r\n\r\n  const onModalClose = () => {\r\n    resetState()\r\n  }\r\n\r\n  const handleSubmit = async (e: Event) => {\r\n    e.preventDefault()\r\n    loading.value = true\r\n    const res = await createCommunity(state.value)\r\n    loading.value = false\r\n    if (!res) return\r\n    resetState()\r\n    communityCreatorModalOpen.value = false\r\n    setPath(pathStore, `/communities/${res.id}`)\r\n  }\r\n\r\n  const handleChange = (e: Event) => {\r\n    const target = e.target as HTMLInputElement\r\n    state.value[target.id as keyof typeof state.value] = target.value\r\n    state.notify()\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      onclose={onModalClose}\r\n      visible={communityCreatorModalOpen}\r\n      toggle={() => (communityCreatorModalOpen.value = !communityCreatorModalOpen.value)}\r\n    >\r\n      <ModalHeader>\r\n        <h2>Create Community</h2>\r\n      </ModalHeader>\r\n      <ModalBody>\r\n        <form onsubmit={handleSubmit}>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"title\">Name</label>\r\n            <input\r\n              type=\"text\"\r\n              id=\"title\"\r\n              oninput={handleChange}\r\n              watch={state}\r\n              bind:value={() => state.value.title}\r\n            />\r\n          </div>\r\n\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"description\">Description</label>\r\n            <textarea\r\n              id=\"description\"\r\n              oninput={handleChange}\r\n              watch={state}\r\n              bind:value={() => state.value.description}\r\n            ></textarea>\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <Button\r\n              type=\"submit\"\r\n              className=\"btn btn-primary hover-animate\"\r\n              watch={[loading, state]}\r\n              bind:disabled={() =>\r\n                loading.value ||\r\n                !communityValidation.isCommunityValid(state.value.title, state.value.description)\r\n              }\r\n            >\r\n              Create\r\n              <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n            </Button>\r\n          </div>\r\n        </form>\r\n      </ModalBody>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { Button } from \"../Button\"\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from \"../modal/Modal\"\r\nimport { postValidation } from \"../../db/validation\"\r\nimport { addPost } from \"../../client/actions/posts\"\r\nimport { userStore } from \"../../state/global\"\r\nimport { selectedCommunity, postCreatorModalOpen } from \"../../state/community\"\r\nimport { addNotification } from \"../Notifications\"\r\n\r\nexport const PostCreator = () => {\r\n  const loading = createSignal(false)\r\n  const state = createSignal({\r\n    title: \"\",\r\n    content: \"\",\r\n  })\r\n\r\n  const createPost = async () => {\r\n    const { title, content } = state.value\r\n    const { userId } = userStore.value ?? {}\r\n    if (!userId)\r\n      return addNotification({\r\n        type: \"error\",\r\n        text: \"You must be logged in to create a post\",\r\n      })\r\n\r\n    if (!selectedCommunity.value) {\r\n      return addNotification({\r\n        type: \"error\",\r\n        text: \"No community selected\",\r\n      })\r\n    }\r\n    loading.value = true\r\n\r\n    console.log(\"Create post\", state.value, selectedCommunity, userId)\r\n    const res = await addPost({\r\n      title,\r\n      content,\r\n      communityId: selectedCommunity.value.id!,\r\n      ownerId: userId,\r\n    })\r\n\r\n    if (res.message) {\r\n      loading.value = false\r\n      addNotification({\r\n        type: \"error\",\r\n        text: res.message,\r\n      })\r\n      return\r\n    }\r\n\r\n    addNotification({\r\n      type: \"success\",\r\n      text: \"Post created\",\r\n    })\r\n    setTimeout(() => {\r\n      window.location.reload()\r\n    }, 1000)\r\n  }\r\n\r\n  const handleChange = (e: Event) => {\r\n    const target = e.target as HTMLInputElement\r\n    state.value[target.id as keyof typeof state.value] = target.value\r\n    state.notify()\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Modal visible={postCreatorModalOpen} toggle={() => (postCreatorModalOpen.value = false)}>\r\n        <ModalHeader>\r\n          <h2>Create post</h2>\r\n        </ModalHeader>\r\n        <ModalBody>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"title\">Title</label>\r\n            <input\r\n              id=\"title\"\r\n              type=\"text\"\r\n              bind:value={() => state.value.title}\r\n              oninput={handleChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"content\">Content</label>\r\n            <textarea id=\"content\" bind:value={() => state.value.content} oninput={handleChange} />\r\n          </div>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button\r\n            className=\"btn btn-secondary hover-animate\"\r\n            watch={loading}\r\n            bind:disabled={() => loading.value}\r\n            onclick={() => (postCreatorModalOpen.value = false)}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            className=\"btn btn-primary hover-animate\"\r\n            watch={[loading, state]}\r\n            bind:disabled={() =>\r\n              loading.value || !postValidation.isPostValid(state.value.title, state.value.content)\r\n            }\r\n            onclick={createPost}\r\n          >\r\n            Create post\r\n          </Button>\r\n        </ModalFooter>\r\n      </Modal>\r\n    </>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal, computed } from \"cinnabun\"\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from \"../modal/Modal\"\r\nimport { communityEditorModalOpen, selectedCommunity } from \"../../state/community\"\r\nimport { Button } from \"../Button\"\r\nimport { communityValidation } from \"../../db/validation\"\r\nimport { updateCommunity } from \"../../client/actions/communities\"\r\nimport { addNotification } from \"../Notifications\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\n\r\nexport const CommunityEditor = () => {\r\n  const loading = createSignal(false)\r\n\r\n  const state = computed(selectedCommunity, () => {\r\n    return {\r\n      title: selectedCommunity.value?.title ?? \"\",\r\n      description: selectedCommunity.value?.description ?? \"\",\r\n      private: selectedCommunity.value?.private ?? false,\r\n    }\r\n  })\r\n\r\n  const saveCommunity = async (e: Event) => {\r\n    e.preventDefault()\r\n    e.stopPropagation()\r\n    if (!selectedCommunity.value) return\r\n    loading.value = true\r\n\r\n    const res = await updateCommunity({\r\n      ...state.value,\r\n      id: selectedCommunity.value.id,\r\n    })\r\n    loading.value = false\r\n    if (res) {\r\n      const titleChanged = state.value.title !== selectedCommunity.value.title\r\n      if (titleChanged) {\r\n        setTimeout(() => {\r\n          window.location.pathname = `/communities/${res.url_title}`\r\n        }, 1500)\r\n      }\r\n      addNotification({\r\n        text: \"Community updated\" + (titleChanged ? \" - redirecting...\" : \"\"),\r\n        type: \"success\",\r\n      })\r\n      Object.assign(selectedCommunity.value, res)\r\n      communityEditorModalOpen.value = false\r\n    }\r\n  }\r\n\r\n  const reset = () => {\r\n    state.value = {\r\n      title: selectedCommunity.value?.title ?? \"\",\r\n      description: selectedCommunity.value?.description ?? \"\",\r\n      private: selectedCommunity.value?.private ?? false,\r\n    }\r\n  }\r\n\r\n  const hasChanged = () => {\r\n    return (\r\n      state.value?.title !== selectedCommunity.value?.title ||\r\n      state.value?.description !== selectedCommunity.value?.description ||\r\n      state.value?.private !== selectedCommunity.value?.private\r\n    )\r\n  }\r\n\r\n  const handleChange = (e: Event) => {\r\n    const target = e.target as HTMLInputElement\r\n    const value = target.type === \"checkbox\" ? target.checked : target.value\r\n\r\n    //@ts-ignore\r\n    state.value[target.id as keyof typeof state.value] = value\r\n    state.notify()\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      visible={communityEditorModalOpen}\r\n      toggle={() => (communityEditorModalOpen.value = false)}\r\n      onclose={reset}\r\n    >\r\n      <form onsubmit={saveCommunity}>\r\n        <ModalHeader>\r\n          <h2>Edit Community</h2>\r\n        </ModalHeader>\r\n        <ModalBody>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"title\">Title</label>\r\n            <input\r\n              id=\"title\"\r\n              type=\"text\"\r\n              className=\"form-control\"\r\n              watch={state}\r\n              bind:value={() => state.value?.title ?? \"\"}\r\n              oninput={handleChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <label htmlFor=\"desc\">Description</label>\r\n            <textarea\r\n              id=\"description\"\r\n              className=\"form-control\"\r\n              watch={state}\r\n              bind:value={() => state.value?.description ?? \"\"}\r\n              oninput={handleChange}\r\n            />\r\n          </div>\r\n          <div className=\"form-group flex-row\">\r\n            <label htmlFor=\"private\">Private</label>\r\n            <input\r\n              id=\"private\"\r\n              type=\"checkbox\"\r\n              className=\"form-control\"\r\n              watch={state}\r\n              bind:checked={() => state.value?.private ?? false}\r\n              oninput={handleChange}\r\n            />\r\n          </div>\r\n        </ModalBody>\r\n        <ModalFooter>\r\n          <Button\r\n            type=\"button\"\r\n            className=\"btn btn-secondary hover-animate\"\r\n            watch={loading}\r\n            bind:disabled={() => loading.value}\r\n            onclick={() => (communityEditorModalOpen.value = false)}\r\n          >\r\n            Cancel\r\n          </Button>\r\n          <Button\r\n            watch={[loading, state]}\r\n            bind:disabled={() =>\r\n              loading.value ||\r\n              !communityValidation.isCommunityValid(\r\n                state.value?.title ?? \"\",\r\n                state.value?.description ?? \"\"\r\n              ) ||\r\n              !hasChanged()\r\n            }\r\n            className=\"btn btn-primary hover-animate\"\r\n          >\r\n            Save\r\n            <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n          </Button>\r\n        </ModalFooter>\r\n      </form>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { Modal, ModalHeader, ModalBody } from \"../modal/Modal\"\r\nimport { Button } from \"../Button\"\r\nimport { joinCommunity } from \"../../client/actions/communities\"\r\nimport { addNotification } from \"../Notifications\"\r\nimport { JoinResultType } from \"../../types/community\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\nimport { selectedCommunity, communityJoinModalOpen } from \"../../state/community\"\r\nimport { pathStore } from \"../../state/global\"\r\n\r\nexport const CommunityJoinPrompt = () => {\r\n  const loading = createSignal(false)\r\n\r\n  const isPrivate = () => selectedCommunity.value?.private ?? false\r\n\r\n  const reloadCommmunity = () => {\r\n    const communityTitle = selectedCommunity.value?.url_title\r\n    window.history.pushState({}, \"\", `/communities/${communityTitle}`)\r\n    pathStore.value = `/communities/${communityTitle}`\r\n    communityJoinModalOpen.value = false\r\n  }\r\n\r\n  const join = async () => {\r\n    const communityTitle = selectedCommunity.value?.url_title\r\n    if (!communityTitle) return addNotification({ type: \"error\", text: \"No community selected.\" })\r\n    loading.value = true\r\n    const res = await joinCommunity(communityTitle)\r\n    loading.value = false\r\n    if (!res) return\r\n\r\n    switch (res.type) {\r\n      case JoinResultType.AlreadyJoined:\r\n        addNotification({ type: \"error\", text: \"You are already a member of this community.\" })\r\n        reloadCommmunity()\r\n        break\r\n      case JoinResultType.Error:\r\n        addNotification({ type: \"error\", text: \"An error occurred while joining the community.\" })\r\n        break\r\n      case JoinResultType.Success:\r\n        addNotification({ type: \"success\", text: \"You have joined the community.\" })\r\n        reloadCommmunity()\r\n        break\r\n      case JoinResultType.Banned:\r\n        addNotification({ type: \"error\", text: \"You are banned from this community.\" })\r\n        break\r\n      case JoinResultType.Pending:\r\n        addNotification({\r\n          type: \"success\",\r\n          text: \"You have requested to join the community. Sit tight!\",\r\n        })\r\n        break\r\n      default:\r\n        break\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Modal toggle={() => (communityJoinModalOpen.value = false)} visible={communityJoinModalOpen}>\r\n      <ModalHeader>\r\n        <h2>Join Community</h2>\r\n      </ModalHeader>\r\n      <ModalBody>\r\n        <div className=\"flex flex-column gap\">\r\n          <p className=\"text-muted m-0\">\r\n            <small watch={selectedCommunity} bind:children>\r\n              {() =>\r\n                isPrivate() ? (\r\n                  <i>This private community requires membership to view information.</i>\r\n                ) : (\r\n                  <i>Joining this community will allow you to post and comment.</i>\r\n                )\r\n              }\r\n            </small>\r\n          </p>\r\n          <div className=\"flex gap justify-content-between\">\r\n            <Button\r\n              watch={loading}\r\n              bind:disabled={() => loading.value}\r\n              onclick={() => (communityJoinModalOpen.value = false)}\r\n              className=\"btn btn-secondary hover-animate\"\r\n            >\r\n              Cancel\r\n            </Button>\r\n            <Button\r\n              watch={loading}\r\n              bind:disabled={() => loading.value}\r\n              onclick={join}\r\n              className=\"btn btn-primary hover-animate\"\r\n            >\r\n              Join\r\n              <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n            </Button>\r\n          </div>\r\n        </div>\r\n      </ModalBody>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const GoogleIcon = () => {\r\n  return (\r\n    <svg width=\"1rem\" viewBox=\"0 0 16 16\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\">\r\n      <path\r\n        fill=\"#4285F4\"\r\n        d=\"M14.9 8.161c0-.476-.039-.954-.121-1.422h-6.64v2.695h3.802a3.24 3.24 0 01-1.407 2.127v1.75h2.269c1.332-1.22 2.097-3.02 2.097-5.15z\"\r\n      />\r\n      <path\r\n        fill=\"#34A853\"\r\n        d=\"M8.14 15c1.898 0 3.499-.62 4.665-1.69l-2.268-1.749c-.631.427-1.446.669-2.395.669-1.836 0-3.393-1.232-3.952-2.888H1.85v1.803A7.044 7.044 0 008.14 15z\"\r\n      />\r\n      <path\r\n        fill=\"#FBBC04\"\r\n        d=\"M4.187 9.342a4.17 4.17 0 010-2.68V4.859H1.849a6.97 6.97 0 000 6.286l2.338-1.803z\"\r\n      />\r\n      <path\r\n        fill=\"#EA4335\"\r\n        d=\"M8.14 3.77a3.837 3.837 0 012.7 1.05l2.01-1.999a6.786 6.786 0 00-4.71-1.82 7.042 7.042 0 00-6.29 3.858L4.186 6.66c.556-1.658 2.116-2.89 3.952-2.89z\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const GithubIcon = () => {\r\n  return (\r\n    <svg\r\n      width=\"1rem\"\r\n      viewBox=\"0 -0.5 24 24\"\r\n      id=\"meteor-icon-kit__regular-github\"\r\n      fill=\"none\"\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n    >\r\n      <path\r\n        fill-rule=\"evenodd\"\r\n        clip-rule=\"evenodd\"\r\n        d=\"M12.2047 0.00001C6.56031 -0.005731 1.74628 4.08615 0.842541 9.6577C-0.061195 15.2293 3.2126 20.6331 8.56941 22.4118C9.14823 22.5177 9.35294 22.1577 9.35294 21.8541C9.35294 21.5506 9.35294 20.8588 9.35294 19.8988C6.14117 20.5977 5.46353 18.3529 5.46353 18.3529C5.25046 17.6572 4.79779 17.0595 4.18588 16.6659C3.14823 15.96 4.27059 15.96 4.27059 15.96C5.00761 16.0641 5.65578 16.5014 6.02823 17.1459C6.34368 17.7179 6.87393 18.1406 7.50179 18.3208C8.12965 18.5009 8.8034 18.4236 9.37411 18.1059C9.41842 17.5252 9.66876 16.9794 10.08 16.5671C7.5247 16.2777 4.84235 15.2894 4.84235 10.92C4.82481 9.7786 5.24688 8.67412 6.02117 7.8353C5.67632 6.84285 5.71662 5.7571 6.13412 4.79295C6.13412 4.79295 7.10117 4.48236 9.29647 5.97177C11.1816 5.45419 13.1713 5.45419 15.0565 5.97177C17.2518 4.48236 18.2118 4.79295 18.2118 4.79295C18.6351 5.74689 18.6854 6.82486 18.3529 7.81412C19.1272 8.65294 19.5493 9.7574 19.5318 10.8988C19.5318 15.3177 16.8424 16.2847 14.28 16.5459C14.8359 17.1047 15.1218 17.8774 15.0635 18.6635C15.0635 20.2024 15.0635 21.4447 15.0635 21.8188C15.0635 22.1929 15.2682 22.4824 15.8541 22.3694C21.1473 20.5447 24.3569 15.1728 23.4554 9.6469C22.5539 4.1211 17.8034 0.04779 12.2047 0.00001z\"\r\n        fill=\"#758CA3\"\r\n      />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from \"../modal/Modal\"\r\nimport { authModalOpen, authModalState } from \"../../state/global\"\r\nimport { Button } from \"../Button\"\r\nimport { GoogleIcon } from \"../icons/auth/GoogleIcon\"\r\nimport { GithubIcon } from \"../icons/auth/GithubIcon\"\r\n\r\nconst AuthModalProviderList = () => {\r\n  const options = [\r\n    {\r\n      title: \"Google\",\r\n      icon: GoogleIcon,\r\n    },\r\n    {\r\n      title: \"Github\",\r\n      icon: GithubIcon,\r\n    },\r\n  ]\r\n\r\n  const handleOptionClick = (option: (typeof options)[0]) => {\r\n    window.location.href = `/login/${option.title.toLowerCase()}`\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex gap flex-column text-center\">\r\n      {options.map((option) => (\r\n        <a\r\n          href={`/login/${option.title.toLowerCase()}`}\r\n          className=\"btn flex gap-sm p-3 auth-provider shadow\"\r\n          onclick={(e: Event) => {\r\n            e.preventDefault()\r\n            handleOptionClick(option)\r\n          }}\r\n        >\r\n          <option.icon />\r\n          <small>Continue with {option.title}</small>\r\n        </a>\r\n      ))}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const AuthModal = () => {\r\n  return (\r\n    <Modal visible={authModalOpen} toggle={() => (authModalOpen.value = false)}>\r\n      <ModalHeader>\r\n        <h4 className=\"m-0\">{() => authModalState.value.title}</h4>\r\n      </ModalHeader>\r\n      <ModalBody style=\"line-height:1.3rem\">\r\n        <small className=\"text-muted m-0\">\r\n          <i>{() => authModalState.value.message}</i>\r\n        </small>\r\n        <br />\r\n        <br />\r\n        <div>\r\n          <AuthModalProviderList />\r\n        </div>\r\n      </ModalBody>\r\n      <ModalFooter>\r\n        <Button\r\n          className=\"btn btn-secondary hover-animate\"\r\n          onclick={() => (authModalOpen.value = false)}\r\n        >\r\n          Cancel\r\n        </Button>\r\n      </ModalFooter>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { getCommunitySearch } from \"../../client/actions/communities\"\r\nimport \"./CommunitySearch.css\"\r\nimport { CommunitySearchData, CommunityLinkData } from \"../../types/community\"\r\nimport { Link } from \"cinnabun/router\"\r\nimport { pathStore } from \"../../state/global\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\nimport { KeyboardListener } from \"cinnabun/listeners\"\r\n\r\nconst inputState = createSignal(\"\")\r\nconst loading = createSignal(false)\r\nconst results = createSignal<CommunitySearchData | null>(null)\r\n\r\nexport const CommunitySearch = () => {\r\n  let inputEl: HTMLInputElement | null = null\r\n  const handleChange = (e: Event) => {\r\n    const target = e.target as HTMLInputElement\r\n    inputState.value = target.value\r\n  }\r\n\r\n  const onMounted = (self: Cinnabun.Component) => {\r\n    inputEl = self.element as HTMLInputElement\r\n  }\r\n\r\n  const focusSearchInput = (e: Event) => {\r\n    const kbEvnt = e as KeyboardEvent\r\n    if (kbEvnt.metaKey || kbEvnt.ctrlKey) {\r\n      e.preventDefault()\r\n      inputEl?.focus()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"community-search\">\r\n      <KeyboardListener keys={[\"k\"]} onCapture={(_, e) => focusSearchInput(e)} />\r\n      <KeyboardListener keys={[\"Escape\"]} onCapture={() => inputEl?.blur()} />\r\n      <div className=\"input-wrapper\">\r\n        <input\r\n          type=\"text\"\r\n          watch={inputState}\r\n          bind:value={() => inputState.value}\r\n          oninput={handleChange}\r\n          placeholder=\"Search for a community\"\r\n          onMounted={onMounted}\r\n        />\r\n        <EllipsisLoader className=\"loader\" watch={loading} bind:visible={() => loading.value} />\r\n      </div>\r\n      <ResultsList />\r\n    </div>\r\n  )\r\n}\r\n\r\nconst ResultsList = () => {\r\n  let unsub: { (): void } | undefined = undefined\r\n  let timeout: number | undefined = undefined\r\n\r\n  const onMounted = () => {\r\n    unsub = inputState.subscribe(async (val) => {\r\n      if (val.length === 0) {\r\n        results.value = null\r\n        return\r\n      }\r\n\r\n      if (val.length < 3) return\r\n      if (val === results.value?.search) return\r\n\r\n      // queue up a search action using setTimeout - if we type again before it resolves, it will cancel the previous one\r\n      if (timeout) window.clearTimeout(timeout)\r\n      loading.value = true\r\n      timeout = window.setTimeout(async () => {\r\n        const data = await getCommunitySearch(val)\r\n        if (!data) return\r\n\r\n        results.value = data\r\n        loading.value = false\r\n      }, 250)\r\n    })\r\n  }\r\n  const onUnmounted = () => {\r\n    if (unsub) unsub()\r\n  }\r\n  return (\r\n    <ul onMounted={onMounted} onUnmounted={onUnmounted} watch={results} bind:children>\r\n      {() =>\r\n        results.value ? (\r\n          results.value.communities.map((community) => <ResultItem community={community} />)\r\n        ) : (\r\n          <></>\r\n        )\r\n      }\r\n    </ul>\r\n  )\r\n}\r\n\r\nconst ResultItem = ({ community }: { community: CommunityLinkData }) => {\r\n  const handleNavigate = () => {\r\n    loading.value = false\r\n    results.value = null\r\n    inputState.value = \"\"\r\n  }\r\n  return (\r\n    <li onclick={handleNavigate}>\r\n      <Link store={pathStore} to={`/communities/${community.url_title}`} className=\"community-link\">\r\n        {community.title}\r\n      </Link>\r\n    </li>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const UsersIcon = () => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n    >\r\n      <path d=\"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2\" />\r\n      <circle cx=\"9\" cy=\"7\" r=\"4\" />\r\n      <path d=\"M22 21v-2a4 4 0 0 0-3-3.87\" />\r\n      <path d=\"M16 3.13a4 4 0 0 1 0 7.75\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\n\r\nexport const GlobeIcon = () => {\r\n  return (\r\n    <svg\r\n      xmlns=\"http://www.w3.org/2000/svg\"\r\n      width=\"1rem\"\r\n      viewBox=\"0 0 24 24\"\r\n      fill=\"none\"\r\n      stroke=\"currentColor\"\r\n      stroke-width=\"2\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n    >\r\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\r\n      <line x1=\"2\" x2=\"22\" y1=\"12\" y2=\"12\" />\r\n      <path d=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\" />\r\n    </svg>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { sidebarOpen } from \"../state/global\"\r\nimport { Button } from \"./Button\"\r\nimport { MenuIcon } from \"./icons/MenuIcon\"\r\n\r\nexport const MenuButton = ({ className }: { className?: string }) => {\r\n  return (\r\n    <Button\r\n      className={`icon-button menu-button ${className}`}\r\n      onclick={() => (sidebarOpen.value = !sidebarOpen.value)}\r\n    >\r\n      <MenuIcon />\r\n    </Button>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { pathStore, sidebarOpen } from \"../../state/global\"\r\nimport { Link } from \"cinnabun/router\"\r\nimport \"./Sidebar.css\"\r\nimport { UsersIcon } from \"../icons/UsersIcon\"\r\nimport { GlobeIcon } from \"../icons/GlobeIcon\"\r\nimport { SlideInOut, Transition } from \"cinnabun-transitions\"\r\nimport { MenuButton } from \"../MenuButton\"\r\nimport { NavigationListener } from \"cinnabun/listeners\"\r\n\r\nconst onBeforeNavigate = () => {\r\n  sidebarOpen.value = false\r\n\r\n  return true\r\n}\r\n\r\nexport const Sidebar = () => {\r\n  return (\r\n    <>\r\n      <Transition\r\n        className=\"sidebar-background\"\r\n        properties={[{ name: \"opacity\", from: \"0\", to: \"1\", ms: 300 }]}\r\n        watch={sidebarOpen}\r\n        bind:visible={() => sidebarOpen.value}\r\n        onclick={() => (sidebarOpen.value = false)}\r\n      />\r\n      <SlideInOut\r\n        settings={{ from: \"left\" }}\r\n        className=\"sidebar-container\"\r\n        watch={sidebarOpen}\r\n        bind:visible={() => sidebarOpen.value}\r\n      >\r\n        <NavigationListener onCapture={() => (sidebarOpen.value = false)} />\r\n        <header className=\"sidebar-header\">\r\n          <div className=\"sidebar-header-item\">\r\n            <MenuButton />\r\n          </div>\r\n        </header>\r\n        <section className=\"sidebar-content\">\r\n          <div className=\"sidebar-content-item\">\r\n            <Link\r\n              to=\"/communities\"\r\n              onBeforeNavigate={onBeforeNavigate}\r\n              store={pathStore}\r\n              className=\"sidebar-link\"\r\n            >\r\n              <GlobeIcon />\r\n              <span className=\"collapse-text\">Communities</span>\r\n            </Link>\r\n          </div>\r\n          <div className=\"sidebar-content-item\">\r\n            <Link\r\n              onBeforeNavigate={onBeforeNavigate}\r\n              to=\"/users\"\r\n              store={pathStore}\r\n              className=\"sidebar-link\"\r\n            >\r\n              <UsersIcon />\r\n              <span className=\"collapse-text\">People</span>\r\n            </Link>\r\n          </div>\r\n        </section>\r\n        <section className=\"sidebar-footer\">\r\n          <div className=\"sidebar-footer-item\">\r\n            <Link\r\n              onBeforeNavigate={onBeforeNavigate}\r\n              to=\"/settings\"\r\n              store={pathStore}\r\n              className=\"sidebar-link\"\r\n            >\r\n              <span className=\"collapse-text\">Settings</span>\r\n            </Link>\r\n          </div>\r\n        </section>\r\n      </SlideInOut>\r\n    </>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { ComponentChildren, ComponentProps } from \"cinnabun/types\"\r\nimport { KeyboardListener, NavigationListener } from \"cinnabun/listeners\"\r\nimport { FadeInOut, SlideInOut } from \"cinnabun-transitions\"\r\nimport \"./Drawer.css\"\r\n\r\ntype DrawerGestureProps = {\r\n  closeOnNavigate?: boolean\r\n  closeOnClickOutside?: boolean\r\n  closeOnEscape?: boolean\r\n}\r\nconst defaultGestures: DrawerGestureProps = {\r\n  closeOnNavigate: true,\r\n  closeOnClickOutside: true,\r\n  closeOnEscape: true,\r\n}\r\n\r\ntype DrawerProps = {\r\n  visible: Cinnabun.Signal<boolean>\r\n  side: \"left\" | \"right\" | \"top\" | \"bottom\"\r\n  toggle: () => void\r\n  onclose?: () => void\r\n  gestures?: DrawerGestureProps\r\n}\r\nexport const Drawer = (\r\n  { visible, side, toggle, onclose, gestures = {} }: DrawerProps,\r\n  children: ComponentChildren\r\n) => {\r\n  const _gestures = { ...defaultGestures, ...gestures }\r\n  const { closeOnNavigate, closeOnClickOutside, closeOnEscape } = _gestures\r\n\r\n  return (\r\n    <FadeInOut\r\n      properties={[{ name: \"opacity\", from: 0, to: 1, ms: 350 }]}\r\n      className=\"drawer-outer\"\r\n      tabIndex={-1}\r\n      watch={visible}\r\n      bind:visible={() => {\r\n        if (!visible.value && onclose) onclose()\r\n        return visible.value\r\n      }}\r\n      onmouseup={(e: MouseEvent) => {\r\n        if (!visible.value || !closeOnClickOutside) return\r\n        const el = e.target as HTMLDivElement\r\n        if (el.className === \"drawer-outer\") toggle()\r\n      }}\r\n    >\r\n      <SlideInOut\r\n        className={`drawer drawer-${side} flex flex-column`}\r\n        watch={visible}\r\n        bind:visible={() => visible.value}\r\n        settings={{ from: side }}\r\n      >\r\n        <NavigationListener onCapture={() => closeOnNavigate && toggle()} />\r\n        <KeyboardListener keys={[\"Escape\"]} onCapture={() => closeOnEscape && toggle()} />\r\n        {children}\r\n      </SlideInOut>\r\n    </FadeInOut>\r\n  )\r\n}\r\n\r\nexport const DrawerHeader = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"drawer-header\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const DrawerBody = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"drawer-body flex-grow\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n\r\nexport const DrawerFooter = (props: ComponentProps, children: ComponentChildren) => {\r\n  return (\r\n    <div className=\"drawer-footer\" {...props}>\r\n      {children}\r\n    </div>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Drawer, DrawerBody, DrawerHeader } from \"../drawer/Drawer\"\r\nimport { communityDrawerOpen, communityDrawerState } from \"../../state/community\"\r\n\r\nexport const CommunityDrawer = () => {\r\n  return (\r\n    <Drawer\r\n      visible={communityDrawerOpen}\r\n      side=\"right\"\r\n      toggle={() => (communityDrawerOpen.value = false)}\r\n    >\r\n      <DrawerHeader>\r\n        <h2 className=\"m-0\">{() => communityDrawerState.value.title}</h2>\r\n      </DrawerHeader>\r\n      <DrawerBody>\r\n        {() =>\r\n          communityDrawerState.value.componentFunc ? (\r\n            communityDrawerState.value.componentFunc()\r\n          ) : (\r\n            <></>\r\n          )\r\n        }\r\n      </DrawerBody>\r\n    </Drawer>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from \"../modal/Modal\"\r\nimport { Button } from \"../Button\"\r\nimport { addNotification } from \"../Notifications\"\r\nimport { leaveCommunity } from \"../../client/actions/communities\"\r\nimport { LeaveResultType } from \"../../types/community\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\nimport { selectedCommunity, communityLeaveModalOpen } from \"../../state/community\"\r\nimport { pathStore } from \"../../state/global\"\r\n\r\nexport const CommunityLeaveConfirmation = () => {\r\n  const loading = createSignal(false)\r\n\r\n  const reloadCommmunity = () => {\r\n    const communityTitle = selectedCommunity.value?.url_title\r\n    window.history.pushState({}, \"\", `/communities/${communityTitle}`)\r\n    pathStore.value = `/communities/${communityTitle}`\r\n    communityLeaveModalOpen.value = false\r\n  }\r\n\r\n  const leave = async () => {\r\n    const communityId = selectedCommunity.value?.id\r\n    if (!communityId) return addNotification({ type: \"error\", text: \"No community selected.\" })\r\n    loading.value = true\r\n    const res = await leaveCommunity(communityId)\r\n    loading.value = false\r\n    if (!res) return\r\n\r\n    switch (res.type) {\r\n      case LeaveResultType.Success:\r\n        addNotification({ type: \"success\", text: \"You have left the community.\" })\r\n        break\r\n      case LeaveResultType.Error:\r\n        addNotification({ type: \"error\", text: \"An error occurred while leaving the community.\" })\r\n        break\r\n      case LeaveResultType.NotAMember:\r\n        addNotification({ type: \"error\", text: \"You're already not a member of the community.\" })\r\n        break\r\n      default:\r\n        console.error(\"Unhandled leave result type:\", res.type)\r\n        break\r\n    }\r\n    reloadCommmunity()\r\n  }\r\n\r\n  return (\r\n    <Modal toggle={() => (communityLeaveModalOpen.value = false)} visible={communityLeaveModalOpen}>\r\n      <ModalHeader>\r\n        <h2>Leave Community</h2>\r\n      </ModalHeader>\r\n      <ModalBody>\r\n        <p>Are you really sure you want to leave this community?</p>\r\n      </ModalBody>\r\n      <ModalFooter>\r\n        <Button\r\n          type=\"button\"\r\n          className=\"btn btn-secondary hover-animate\"\r\n          watch={loading}\r\n          bind:disabled={() => loading.value}\r\n          onclick={() => (communityLeaveModalOpen.value = false)}\r\n        >\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          className=\"btn btn-danger hover-animate\"\r\n          watch={loading}\r\n          bind:disabled={() => loading.value}\r\n          onclick={leave}\r\n        >\r\n          Leave\r\n          <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n        </Button>\r\n      </ModalFooter>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { createSignal } from \"cinnabun\"\r\nimport { Modal, ModalBody, ModalFooter, ModalHeader } from \"../modal/Modal\"\r\nimport { pathStore } from \"../../state/global\"\r\nimport {\r\n  selectedCommunity,\r\n  communityDeleteModalOpen,\r\n  communityHasMembers,\r\n} from \"../../state/community\"\r\nimport { Button } from \"../Button\"\r\nimport { deleteCommunity } from \"../../client/actions/communities\"\r\nimport { addNotification } from \"../Notifications\"\r\nimport { setPath } from \"cinnabun/router\"\r\nimport { EllipsisLoader } from \"../loaders/Ellipsis\"\r\n\r\nexport const CommunityDeleteConfirmation = () => {\r\n  const loading = createSignal(false)\r\n  const confirmText = createSignal(\"\")\r\n\r\n  const handleDelete = async () => {\r\n    if (confirmText.value !== selectedCommunity.value!.title) {\r\n      addNotification({\r\n        text: \"Confirmation text does not match!\",\r\n        type: \"error\",\r\n      })\r\n      return\r\n    }\r\n    if (!selectedCommunity.value?.id) {\r\n      addNotification({\r\n        text: \"No community selected!\",\r\n        type: \"error\",\r\n      })\r\n      return\r\n    }\r\n    loading.value = true\r\n    const res = await deleteCommunity(selectedCommunity.value?.id)\r\n    communityDeleteModalOpen.value = false\r\n    setPath(pathStore, \"/communities\")\r\n    loading.value = false\r\n    if (!res) return\r\n\r\n    addNotification({\r\n      text: \"Community deleted.\",\r\n      type: \"success\",\r\n    })\r\n  }\r\n\r\n  return (\r\n    <Modal\r\n      visible={communityDeleteModalOpen}\r\n      toggle={() => (communityDeleteModalOpen.value = false)}\r\n    >\r\n      <ModalHeader>\r\n        <h2>Delete Community</h2>\r\n      </ModalHeader>\r\n      <ModalBody watch={selectedCommunity} bind:children>\r\n        {() =>\r\n          communityHasMembers() ? (\r\n            <>\r\n              <i>This community has members. Consider transferring ownership instead!</i>\r\n            </>\r\n          ) : (\r\n            <></>\r\n          )\r\n        }\r\n        <p>\r\n          <small>\r\n            Are you really sure you want to delete this community and everything within it?{\" \"}\r\n            <b>This can't be undone!</b>\r\n          </small>\r\n        </p>\r\n\r\n        <small>\r\n          Type <b>{() => selectedCommunity.value?.title}</b> to confirm.\r\n        </small>\r\n        <input\r\n          type=\"text\"\r\n          className=\"form-control\"\r\n          watch={confirmText}\r\n          bind:value={() => confirmText.value}\r\n          oninput={(e: InputEvent) => (confirmText.value = (e.target as HTMLInputElement).value)}\r\n        />\r\n      </ModalBody>\r\n      <ModalFooter>\r\n        <Button\r\n          type=\"button\"\r\n          watch={loading}\r\n          bind:disabled={() => loading.value}\r\n          className=\"btn btn-secondary hover-animate\"\r\n          onclick={() => (communityDeleteModalOpen.value = false)}\r\n        >\r\n          Cancel\r\n        </Button>\r\n        <Button\r\n          type=\"button\"\r\n          watch={[confirmText, loading]}\r\n          bind:disabled={() =>\r\n            confirmText.value !== selectedCommunity.value?.title || loading.value\r\n          }\r\n          className=\"btn btn-danger hover-animate\"\r\n          onclick={handleDelete}\r\n        >\r\n          Delete\r\n          <EllipsisLoader watch={loading} bind:visible={() => loading.value} />\r\n        </Button>\r\n      </ModalFooter>\r\n    </Modal>\r\n  )\r\n}\r\n", "import * as Cinnabun from \"cinnabun\"\r\nimport { Router, Route, Link } from \"cinnabun/router\"\r\nimport { UserAvatar } from \"./components/UserAvatar\"\r\nimport { Portal } from \"./components/Portal\"\r\nimport { NotificationTray } from \"./components/Notifications\"\r\nimport { pathStore } from \"./state/global\"\r\n\r\nimport HomePage from \"./pages/Home\"\r\nimport CommunitiesPage from \"./pages/Communities\"\r\nimport CommunityPage from \"./pages/Community/Page\"\r\nimport UserPage from \"./pages/User/Page\"\r\n\r\nimport { CommunityCreator } from \"./components/communities/CommunityCreator\"\r\nimport { PostCreator } from \"./components/community/PostCreator\"\r\nimport { CommunityEditor } from \"./components/community/CommunityEditor\"\r\nimport { CommunityJoinPrompt } from \"./components/community/CommunityJoinPrompt\"\r\nimport { AuthModal } from \"./components/auth/AuthModal\"\r\nimport { CommunitySearch } from \"./components/communities/CommunitySearch\"\r\nimport { Sidebar } from \"./components/sidebar/Sidebar\"\r\nimport { MenuButton } from \"./components/MenuButton\"\r\nimport { CommunityDrawer } from \"./components/community/CommunityDrawer\"\r\nimport { CommunityLeaveConfirmation } from \"./components/community/CommunityLeaveConfirmation\"\r\nimport { CommunityDeleteConfirmation } from \"./components/community/CommunityDeleteConfirmation\"\r\n\r\nconst Header = () => (\r\n  <header>\r\n    <MenuButton className=\"hide-sm\" />\r\n    <Link to=\"/\" store={pathStore}>\r\n      <div id=\"logo\">Project Zeta</div>\r\n    </Link>\r\n\r\n    <CommunitySearch />\r\n    <>\r\n      <ul id=\"main-header-menu\" className=\"none flex-sm\">\r\n        <li>\r\n          <Link to=\"/communities\" store={pathStore}>\r\n            <small>Communities</small>\r\n          </Link>\r\n        </li>\r\n        <li>\r\n          <Link to=\"/users\" store={pathStore}>\r\n            <small>Users</small>\r\n          </Link>\r\n        </li>\r\n      </ul>\r\n    </>\r\n\r\n    <UserAvatar />\r\n  </header>\r\n)\r\n\r\nexport const App = () => {\r\n  return (\r\n    <>\r\n      <Header />\r\n      <div className=\"app-main\">\r\n        <Sidebar />\r\n        <main className=\"container\">\r\n          <Router store={pathStore}>\r\n            <Route path=\"/\" component={HomePage} />\r\n            <Route path=\"/communities\" component={CommunitiesPage} />\r\n            <Route path=\"/communities/:url_title\" component={CommunityPage} />\r\n            <Route path=\"/users\" component={<div>Users</div>} />\r\n            <Route path=\"/users/:userId\" component={UserPage} />\r\n          </Router>\r\n        </main>\r\n      </div>\r\n      <Portal>\r\n        <NotificationTray />\r\n        <PostCreator />\r\n        <CommunityCreator />\r\n        <CommunityEditor />\r\n        <CommunityJoinPrompt />\r\n        <AuthModal />\r\n        <CommunityDrawer />\r\n        <CommunityLeaveConfirmation />\r\n        <CommunityDeleteConfirmation />\r\n      </Portal>\r\n    </>\r\n  )\r\n}\r\n", "import { Signal, createSignal } from \"cinnabun\"\r\n\r\ntype TypedMessage = {\r\n  type: string\r\n  data?: any\r\n}\r\n\r\nexport class LiveSocket {\r\n  socket: any\r\n  public loading: Signal<boolean> = createSignal(true)\r\n\r\n  constructor(url: string) {\r\n    this.socket = new WebSocket(url)\r\n    this.socket.onmessage = (msg: any) => {\r\n      try {\r\n        const data = JSON.parse(msg.data)\r\n        if (!(\"type\" in data)) throw new Error(\"received invalid message\")\r\n        this.handleMessage(data as TypedMessage)\r\n      } catch (error) {\r\n        console.error(error)\r\n      }\r\n    }\r\n    this.socket.onopen = () => {\r\n      setInterval(() => {\r\n        if (this.socket.readyState !== this.socket.OPEN) return\r\n        this.socket.send(JSON.stringify({ type: \"ping\" }))\r\n      }, 3000)\r\n    }\r\n\r\n    this.load()\r\n  }\r\n\r\n  private async load() {\r\n    this.loading.value = false\r\n  }\r\n\r\n  private handleMessage(message: TypedMessage) {\r\n    switch (message.type) {\r\n      case \"ping\":\r\n        return\r\n      default:\r\n        return\r\n    }\r\n  }\r\n}\r\n\r\nexport const createLiveSocket = () => {\r\n  const { hostname, port } = window.location\r\n  const protocol = window.location.protocol === \"https:\" ? \"wss\" : \"ws\"\r\n  return new LiveSocket(`${protocol}://${hostname}:${port}/ws`)\r\n}\r\n", "import \"./styles/page.css\"\r\nimport \"./styles/index.css\"\r\nimport \"./styles/button.css\"\r\nimport \"./styles/avatar.css\"\r\nimport \"./styles/card.css\"\r\nimport \"./styles/utilities.css\"\r\nimport \"./styles/form.css\"\r\nimport \"./styles/badge.css\"\r\n\r\nimport { Hydration } from \"cinnabun/hydration\"\r\nimport { Document } from \"../Document\"\r\nimport { SSRProps } from \"cinnabun/src/types\"\r\nimport { App } from \"../App\"\r\nimport { Cinnabun } from \"cinnabun\"\r\nimport { createLiveSocket } from \"./liveSocket\"\r\n\r\nconst env = process.env.NODE_ENV ?? \"development\"\r\n\r\nif (\"__cbData\" in window) {\r\n  try {\r\n    Cinnabun.registerRuntimeServices(createLiveSocket())\r\n    Hydration.hydrate(Document(App), window.__cbData as SSRProps)\r\n  } catch (error) {\r\n    console.error(error)\r\n  }\r\n\r\n  if (env === \"development\") {\r\n    const evtHandler = new EventSource(\"/sse\")\r\n    let didConnect = false\r\n    evtHandler.addEventListener(\"handshake\", () => {\r\n      didConnect = true\r\n    })\r\n\r\n    evtHandler.addEventListener(\"error\", (evt: Event) => {\r\n      const connIsReset = didConnect && evtHandler.readyState === 0\r\n      if (connIsReset) location.reload()\r\n      console.log(\"evtHandler err evt\", evt)\r\n    })\r\n  }\r\n}\r\n"],
  "mappings": "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",
  "names": ["res", "children", "sc", "c", "App", "onBeforeNavigate", "location", "generateUUID", "generateUUID", "addNotification", "children", "loading", "loading", "loading", "PostCard", "PostCard", "loading", "communityId", "loading", "loading", "getUser", "getUser", "loading", "loading", "loading", "loading", "loading", "defaultGestures", "loading", "loading"]
}
